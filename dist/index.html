<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script>(function(){
    try{
      var stored=localStorage.getItem('theme');
      if(stored==='dark'||stored==='light'){
        document.documentElement.setAttribute('data-theme',stored);
      }else if(window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches){
        document.documentElement.setAttribute('data-theme','dark');
      }
    }catch(e){}
  })();</script>
  <title>BSP Auto â€“ Bookmarklets</title>
  <style>:root {
  color-scheme: light;
  --maxw: 900px;
  --bg: #ffffff;
  --fg: #0f172a;
  --muted: #64748b;
  --accent: #2563eb;
  --accent-fg: #ffffff;
  --card: #f8fafc;
  --border: #e2e8f0;
  --shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
  --shadow-hover: 0 12px 32px rgba(37, 99, 235, 0.18);
  --radius: 14px;
  --tooltip-bg: rgba(15, 23, 42, 0.92);
  --tooltip-fg: #f8fafc;
}

:root[data-theme="dark"],
body[data-theme="dark"] {
  color-scheme: dark;
  --bg: #0b1220;
  --fg: #e2e8f0;
  --muted: #94a3b8;
  --accent: #3b82f6;
  --accent-fg: #0b1220;
  --card: rgba(15, 23, 42, 0.75);
  --border: rgba(148, 163, 184, 0.26);
  --shadow: 0 12px 32px rgba(8, 15, 35, 0.55);
  --shadow-hover: 0 16px 40px rgba(59, 130, 246, 0.28);
  --tooltip-bg: rgba(226, 232, 240, 0.92);
  --tooltip-fg: #0f172a;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Helvetica, Arial;
  background: var(--bg);
  color: var(--fg);
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 100vh;
  padding: 24px 0 32px;
}

.page {
  width: 100%;
  max-width: var(--maxw);
  margin: 0 auto;
  padding: 0 8px;
}

.topbar {
  display: flex;
  justify-content: flex-start;
  padding: 0 8px;
  margin-bottom: 16px;
}


.theme-toggle {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: none;
  background: var(--card);
  color: var(--fg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  line-height: 1;
  cursor: pointer;
  box-shadow: var(--shadow);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.visually-hidden {
  position: absolute !important;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.theme-toggle:hover {
  box-shadow: var(--shadow-hover);
  transform: translateY(-1px);
}

.theme-toggle:focus-visible {
  box-shadow: var(--shadow-hover);
  transform: translateY(-1px);
  outline: 2px solid var(--accent);
  outline-offset: 3px;
}

main {
  background: transparent;
}

h1 {
  text-align: center;
  margin: 0 0 6px;
  font-weight: 700;
  letter-spacing: 0.02em;
}

p.subtitle {
  text-align: center;
  color: var(--muted);
  margin: 0;
}

section.grid {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-top: 32px;
}

article.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px 18px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  box-shadow: var(--shadow);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

article.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-hover);
}

div.row1 {
  display: flex;
  align-items: center;
  gap: 12px;
  justify-content: space-between;
  flex-wrap: wrap;
}

div.row1-left {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
  min-width: 240px;
}

a.btn {
  background: var(--accent);
  color: var(--accent-fg);
  text-decoration: none;
  padding: 10px 16px;
  border-radius: 12px;
  font-weight: 650;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  box-shadow: var(--shadow);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

a.btn:hover,
a.btn:focus-visible {
  box-shadow: var(--shadow-hover);
  transform: translateY(-1px);
  outline: none;
}

span.name {
  font-weight: 600;
}

span.badge {
  font-size: 13px;
  color: var(--muted);
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 4px 10px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: transparent;
}

.actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0;
}

.actions button {
  border-radius: 12px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--fg);
  padding: 8px 12px;
  font-weight: 550;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.actions button:hover,
.actions button:focus-visible {
  box-shadow: var(--shadow-hover);
  transform: translateY(-1px);
  outline: none;
}

details {
  border-top: 1px dashed var(--border);
  margin-top: 6px;
  padding-top: 6px;
}

summary {
  cursor: pointer;
  color: var(--muted);
  font-size: 13px;
}

div.more {
  font-size: 13px;
  color: var(--muted);
  margin-top: 4px;
}

[data-tip] {
  position: relative;
}

[data-tip]:hover::after,
[data-tip]:focus-visible::after {
  content: attr(data-tip);
  position: absolute;
  left: 50%;
  transform: translate(-50%, -8px);
  bottom: 100%;
  background: var(--tooltip-bg);
  color: var(--tooltip-fg);
  padding: 6px 10px;
  border-radius: 10px;
  font-size: 12px;
  white-space: nowrap;
  box-shadow: var(--shadow);
  pointer-events: none;
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    transition-duration: 0s !important;
    animation-duration: 0s !important;
  }
}
</style>
</head>
<body>
  <header class="topbar">
    <button id="themeToggle" class="theme-toggle" type="button" data-tip="Toggle theme" aria-label="Toggle theme">ðŸŒ—</button>
  </header>
  <div class="page">
    <div id="liveRegion" class="visually-hidden" role="status" aria-live="polite" aria-atomic="true"></div>
    <main>
      <h1>BSP Auto â€“ Bookmarklets</h1>
      <p class="subtitle">Drag buttons to your bookmarks bar or click to run.</p>
      <section class="grid">
        <article class="card" data-id="Copy Bookmarklet">
      <div class="row1">
        <div class="row1-left">
          <a class="btn" draggable="true" href="javascript:(function()%7Bjavascript:(()%20=%3E%20%7B%0A%20%20const%20toStringSafe%20=%20(value)%20=%3E%20(value%20==%20null%20?%20%22%22%20:%20String(value));%0A%0A%20%20const%20normalizeWhitespace%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20text%20=%20toStringSafe(value).replace(/%5B%5Cu00a0%5Cu2000-%5Cu200a%5Cu202f%5Cu205f%5Cu3000%5D/g,%20%22%20%22);%0A%20%20%20%20return%20text.replace(/%5Cs+/g,%20%22%20%22).trim();%0A%20%20%7D;%0A%0A%20%20const%20fixAccents%20=%20(value)%20=%3E%0A%20%20%20%20toStringSafe(value)%0A%20%20%20%20%20%20.replace(/d%EF%BF%BDcembre/gi,%20%22d%C3%A9cembre%22)%0A%20%20%20%20%20%20.replace(/f%EF%BF%BDvrier/gi,%20%22f%C3%A9vrier%22)%0A%20%20%20%20%20%20.replace(/ao%EF%BF%BDt/gi,%20%22ao%C3%BBt%22);%0A%0A%20%20const%20monthLookup%20=%20%7B%0A%20%20%20%20janvier:%20%2201%22,%0A%20%20%20%20fevrier:%20%2202%22,%0A%20%20%20%20mars:%20%2203%22,%0A%20%20%20%20avril:%20%2204%22,%0A%20%20%20%20mai:%20%2205%22,%0A%20%20%20%20juin:%20%2206%22,%0A%20%20%20%20juillet:%20%2207%22,%0A%20%20%20%20aout:%20%2208%22,%0A%20%20%20%20septembre:%20%2209%22,%0A%20%20%20%20octobre:%20%2210%22,%0A%20%20%20%20novembre:%20%2211%22,%0A%20%20%20%20decembre:%20%2212%22,%0A%20%20%7D;%0A%0A%20%20const%20removeWeekday%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20weekdays%20=%20%5B%0A%20%20%20%20%20%20%22lundi%22,%0A%20%20%20%20%20%20%22mardi%22,%0A%20%20%20%20%20%20%22mercredi%22,%0A%20%20%20%20%20%20%22jeudi%22,%0A%20%20%20%20%20%20%22vendredi%22,%0A%20%20%20%20%20%20%22samedi%22,%0A%20%20%20%20%20%20%22dimanche%22,%0A%20%20%20%20%5D;%0A%20%20%20%20const%20pattern%20=%20new%20RegExp(%0A%20%20%20%20%20%20%60%5E(?:$%7Bweekdays.join(%22%7C%22)%7D)(?:%5B%5C%5Cs%5C%5Cu00a0%5C%5Cu202f%5C%5Cu2009%5C%5C.,%5D)+%60,%0A%20%20%20%20%20%20%22i%22%0A%20%20%20%20);%0A%20%20%20%20return%20toStringSafe(value).replace(pattern,%20%22%22);%0A%20%20%7D;%0A%0A%20%20const%20normalizeMonthKey%20=%20(value)%20=%3E%0A%20%20%20%20toStringSafe(value)%0A%20%20%20%20%20%20.toLowerCase()%0A%20%20%20%20%20%20.normalize(%22NFD%22)%0A%20%20%20%20%20%20.replace(/%5B%5Cu0300-%5Cu036f%5D/g,%20%22%22)%0A%20%20%20%20%20%20.replace(/%5B%5Ea-z%5D/g,%20%22%22);%0A%0A%20%20const%20getIata%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20matches%20=%20normalizeWhitespace(value).match(/%5Cb%5BA-Z%5D%7B3%7D%5Cb/g);%0A%20%20%20%20return%20matches%20?%20matches%5Bmatches.length%20-%201%5D%20:%20null;%0A%20%20%7D;%0A%0A%20%20const%20getStationCode%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20match%20=%20toStringSafe(value).match(/-%5Cs*(%5Cd%7B4,5%7D)%5Cs*$/);%0A%20%20%20%20return%20match%20?%20match%5B1%5D%20:%20null;%0A%20%20%7D;%0A%0A%20%20const%20getTime%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20text%20=%20toStringSafe(value);%0A%20%20%20%20const%20regex%20=%20/(?:%5E%7C%5B%5E0-9%5D)(%5Cd%7B1,2%7D)%5Cs*%5B:h%5D%5Cs*(%5Cd%7B2%7D)(?!%5Cd)/gi;%0A%20%20%20%20let%20match;%0A%20%20%20%20let%20lastMatch%20=%20null;%0A%20%20%20%20while%20((match%20=%20regex.exec(text))%20!==%20null)%20%7B%0A%20%20%20%20%20%20lastMatch%20=%20match;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!lastMatch)%20return%20null;%0A%20%20%20%20const%20hours%20=%20String(parseInt(lastMatch%5B1%5D,%2010)).padStart(2,%20%220%22);%0A%20%20%20%20const%20minutes%20=%20String(parseInt(lastMatch%5B2%5D,%2010)).padStart(2,%20%220%22);%0A%20%20%20%20return%20%60$%7Bhours%7D:$%7Bminutes%7D%60;%0A%20%20%7D;%0A%0A%20%20const%20getDate%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20cleaned%20=%20normalizeWhitespace(removeWeekday(fixAccents(value)));%0A%20%20%20%20const%20match%20=%20cleaned.match(/(%5Cd%7B1,2%7D)%5Cs+(%5Ba-z%C3%A0%C3%A2%C3%A7%C3%A9%C3%A8%C3%AA%C3%AB%C3%AE%C3%AF%C3%B4%C3%BB%C3%B9%C3%BC%C3%BF%C3%B1%C3%A6%C5%93%5D+)%5Cs+(%5Cd%7B4%7D)/i);%0A%20%20%20%20if%20(!match)%20return%20null;%0A%20%20%20%20const%20day%20=%20String(parseInt(match%5B1%5D,%2010)).padStart(2,%20%220%22);%0A%20%20%20%20const%20monthKey%20=%20normalizeMonthKey(match%5B2%5D);%0A%20%20%20%20const%20month%20=%20monthLookup%5BmonthKey%5D;%0A%20%20%20%20if%20(!month)%20return%20null;%0A%20%20%20%20return%20%60$%7Bmatch%5B3%5D%7D-$%7Bmonth%7D-$%7Bday%7D%60;%0A%20%20%7D;%0A%0A%20%20const%20getSectionData%20=%20(selector,%20keyword)%20=%3E%20%7B%0A%20%20%20%20const%20container%20=%20document.querySelector(%22%23infos%22);%0A%20%20%20%20if%20(!container)%20return%20null;%0A%0A%20%20%20%20const%20title%20=%20Array.from(container.querySelectorAll(selector)).find((node)%20=%3E%0A%20%20%20%20%20%20normalizeWhitespace(node.textContent%20%7C%7C%20%22%22).toLowerCase().includes(keyword)%0A%20%20%20%20);%0A%0A%20%20%20%20if%20(!title)%20return%20null;%0A%0A%20%20%20%20const%20findNextTxt%20=%20(node)%20=%3E%20%7B%0A%20%20%20%20%20%20let%20current%20=%20node.nextElementSibling;%0A%20%20%20%20%20%20while%20(current)%20%7B%0A%20%20%20%20%20%20%20%20if%20(current.classList%20&&%20current.classList.contains(%22txt%22))%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20current;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20current%20=%20current.nextElementSibling;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null;%0A%20%20%20%20%7D;%0A%0A%20%20%20%20const%20stationElement%20=%20findNextTxt(title);%0A%20%20%20%20const%20dateElement%20=%20stationElement%20?%20findNextTxt(stationElement)%20:%20null;%0A%0A%20%20%20%20const%20stationLine%20=%20stationElement%20?%20stationElement.textContent%20:%20%22%22;%0A%20%20%20%20const%20boldNode%20=%20stationElement%20?%20stationElement.querySelector(%22b%22)%20:%20null;%0A%20%20%20%20const%20stationRaw%20=%20normalizeWhitespace(boldNode%20?%20boldNode.textContent%20:%20%22%22);%0A%20%20%20%20const%20stationCode%20=%20stationElement%20?%20getStationCode(normalizeWhitespace(stationLine))%20:%20null;%0A%20%20%20%20const%20iata%20=%20stationRaw%20?%20getIata(stationRaw)%20:%20null;%0A%0A%20%20%20%20const%20dateRaw%20=%20normalizeWhitespace(dateElement%20?%20dateElement.textContent%20:%20%22%22);%0A%20%20%20%20const%20time%20=%20dateRaw%20?%20getTime(dateRaw)%20:%20null;%0A%20%20%20%20const%20date%20=%20dateRaw%20?%20getDate(dateRaw)%20:%20null;%0A%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20station:%20%7B%0A%20%20%20%20%20%20%20%20raw:%20stationRaw%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20stationCode:%20stationCode%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20iata,%0A%20%20%20%20%20%20%7D,%0A%20%20%20%20%20%20datetime:%20%7B%0A%20%20%20%20%20%20%20%20dateRaw:%20dateRaw%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20date:%20date%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20time,%0A%20%20%20%20%20%20%7D,%0A%20%20%20%20%7D;%0A%20%20%7D;%0A%0A%20%20const%20pickupData%20=%20getSectionData(%22.tit%22,%20%22prise%22);%0A%20%20const%20returnData%20=%20getSectionData(%22.tit.top1%22,%20%22retour%22);%0A%0A%20%20const%20result%20=%20%7B%0A%20%20%20%20pickupStation:%20pickupData%0A%20%20%20%20%20%20?%20pickupData.station%0A%20%20%20%20%20%20:%20%7B%20raw:%20null,%20stationCode:%20null,%20iata:%20null%20%7D,%0A%20%20%20%20pickup:%20pickupData%0A%20%20%20%20%20%20?%20pickupData.datetime%0A%20%20%20%20%20%20:%20%7B%20dateRaw:%20null,%20date:%20null,%20time:%20null%20%7D,%0A%20%20%20%20returnStation:%20returnData%0A%20%20%20%20%20%20?%20returnData.station%0A%20%20%20%20%20%20:%20%7B%20raw:%20null,%20stationCode:%20null,%20iata:%20null%20%7D,%0A%20%20%20%20return:%20returnData%0A%20%20%20%20%20%20?%20returnData.datetime%0A%20%20%20%20%20%20:%20%7B%20dateRaw:%20null,%20date:%20null,%20time:%20null%20%7D,%0A%20%20%7D;%0A%0A%20%20const%20logStructuredResult%20=%20(data)%20=%3E%20%7B%0A%20%20%20%20if%20(!data%20%7C%7C%20typeof%20data%20!==%20%22object%22)%20%7B%0A%20%20%20%20%20%20console.warn(%22bspAutoBookingData%20is%20empty%20or%20invalid%22,%20data);%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%0A%20%20%20%20console.group(%22bspAutoBookingData%20(structured)%22);%0A%20%20%20%20%5B%0A%20%20%20%20%20%20%7B%20title:%20%22Pickup%20Station%22,%20value:%20data.pickupStation%20%7D,%0A%20%20%20%20%20%20%7B%20title:%20%22Pickup%20Date/Time%22,%20value:%20data.pickup%20%7D,%0A%20%20%20%20%20%20%7B%20title:%20%22Return%20Station%22,%20value:%20data.returnStation%20%7D,%0A%20%20%20%20%20%20%7B%20title:%20%22Return%20Date/Time%22,%20value:%20data.return%20%7D,%0A%20%20%20%20%5D.forEach((%7B%20title,%20value%20%7D)%20=%3E%20%7B%0A%20%20%20%20%20%20console.group(title);%0A%20%20%20%20%20%20if%20(value%20&&%20typeof%20value%20===%20%22object%22)%20%7B%0A%20%20%20%20%20%20%20%20console.table(%5Bvalue%5D);%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.log(value);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20console.groupEnd();%0A%20%20%20%20%7D);%0A%20%20%20%20console.groupEnd();%0A%20%20%7D;%0A%0A%20%20const%20hasNonNullValue%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20if%20(Array.isArray(value))%20%7B%0A%20%20%20%20%20%20return%20value.some(hasNonNullValue);%0A%20%20%20%20%7D%0A%20%20%20%20if%20(value%20&&%20typeof%20value%20===%20%22object%22)%20%7B%0A%20%20%20%20%20%20return%20Object.values(value).some(hasNonNullValue);%0A%20%20%20%20%7D%0A%20%20%20%20return%20value%20!=%20null;%0A%20%20%7D;%0A%0A%20%20const%20showToast%20=%20(message,%20%7B%20error%20=%20false%20%7D%20=%20%7B%7D)%20=%3E%20%7B%0A%20%20%20%20const%20existing%20=%20document.querySelector(%22%23bsp-auto-toast%22);%0A%20%20%20%20if%20(existing)%20%7B%0A%20%20%20%20%20%20existing.remove();%0A%20%20%20%20%7D%0A%20%20%20%20const%20toast%20=%20document.createElement(%22div%22);%0A%20%20%20%20toast.id%20=%20%22bsp-auto-toast%22;%0A%20%20%20%20toast.style.position%20=%20%22fixed%22;%0A%20%20%20%20toast.style.top%20=%20%2216px%22;%0A%20%20%20%20toast.style.left%20=%20%2250%25%22;%0A%20%20%20%20toast.style.transform%20=%20%22translateX(-50%25)%22;%0A%20%20%20%20toast.style.padding%20=%20%2210px%2016px%22;%0A%20%20%20%20toast.style.background%20=%20error%20?%20%22%23e67e22%22%20:%20%22%232ecc71%22;%0A%20%20%20%20toast.style.color%20=%20%22%23fff%22;%0A%20%20%20%20toast.style.font%20=%20%2214px/1.4%20sans-serif%22;%0A%20%20%20%20toast.style.borderRadius%20=%20%224px%22;%0A%20%20%20%20toast.style.boxShadow%20=%20%220%204px%2012px%20rgba(0,%200,%200,%200.15)%22;%0A%20%20%20%20toast.style.zIndex%20=%20%222147483647%22;%0A%20%20%20%20toast.style.display%20=%20%22flex%22;%0A%20%20%20%20toast.style.alignItems%20=%20%22center%22;%0A%20%20%20%20toast.style.gap%20=%20%2212px%22;%0A%0A%20%20%20%20const%20label%20=%20document.createElement(%22span%22);%0A%20%20%20%20label.textContent%20=%20message;%0A%20%20%20%20toast.appendChild(label);%0A%0A%20%20%20%20document.body.appendChild(toast);%0A%20%20%20%20setTimeout(()%20=%3E%20%7B%0A%20%20%20%20%20%20toast.style.transition%20=%20%22opacity%20200ms%20ease%22;%0A%20%20%20%20%20%20toast.style.opacity%20=%20%220%22;%0A%20%20%20%20%20%20setTimeout(()%20=%3E%20toast.remove(),%20220);%0A%20%20%20%20%7D,%204000);%0A%20%20%7D;%0A%0A%20%20if%20(!hasNonNullValue(result))%20%7B%0A%20%20%20%20console.warn(%22No%20BSP%20data%20found%22,%20result);%0A%20%20%20%20showToast(%22No%20data%20found%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20return;%0A%20%20%7D%0A%0A%20%20try%20%7B%0A%20%20%20%20localStorage.setItem(%22bspAutoBookingData%22,%20JSON.stringify(result));%0A%20%20%20%20console.info(%22bspAutoBookingData%20updated%22,%20result);%0A%20%20%20%20logStructuredResult(result);%0A%20%20%20%20showToast(%22BSP%20data%20copied%22);%0A%20%20%20%20const%20openPasteBookmarkletPage%20=%20()%20=%3E%0A%20%20%20%20%20%20window.open(%0A%20%20%20%20%20%20%20%20%22https://www.bsp-auto.com/auto_2175bsp/tarifs.asp%22,%0A%20%20%20%20%20%20%20%20%22_blank%22,%0A%20%20%20%20%20%20%20%20%22noopener%22%0A%20%20%20%20%20%20);%0A%20%20%20%20setTimeout(openPasteBookmarkletPage,%201000);%0A%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20console.error(%22Failed%20to%20store%20bspAutoBookingData%22,%20error,%20result);%0A%20%20%20%20showToast(%22Failed%20to%20copy%20BSP%20data%22,%20%7B%20error:%20true%20%7D);%0A%20%20%7D%0A%7D)();%0A%7D)();" data-tip="Drag to bookmarks">ðŸ”– Copy â€“ BSP Resa</a>
          <span class="name">Copy Bookmarklet</span>
        </div>
        <span class="badge">Last update: 29/10/2025</span>
      </div>
      <div class="actions">
        <button class="copy" type="button" data-code="javascript%3A(function()%257Bjavascript%3A(()%2520%3D%253E%2520%257B%250A%2520%2520const%2520toStringSafe%2520%3D%2520(value)%2520%3D%253E%2520(value%2520%3D%3D%2520null%2520%3F%2520%2522%2522%2520%3A%2520String(value))%3B%250A%250A%2520%2520const%2520normalizeWhitespace%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520text%2520%3D%2520toStringSafe(value).replace(%2F%255B%255Cu00a0%255Cu2000-%255Cu200a%255Cu202f%255Cu205f%255Cu3000%255D%2Fg%2C%2520%2522%2520%2522)%3B%250A%2520%2520%2520%2520return%2520text.replace(%2F%255Cs%2B%2Fg%2C%2520%2522%2520%2522).trim()%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520fixAccents%2520%3D%2520(value)%2520%3D%253E%250A%2520%2520%2520%2520toStringSafe(value)%250A%2520%2520%2520%2520%2520%2520.replace(%2Fd%25EF%25BF%25BDcembre%2Fgi%2C%2520%2522d%25C3%25A9cembre%2522)%250A%2520%2520%2520%2520%2520%2520.replace(%2Ff%25EF%25BF%25BDvrier%2Fgi%2C%2520%2522f%25C3%25A9vrier%2522)%250A%2520%2520%2520%2520%2520%2520.replace(%2Fao%25EF%25BF%25BDt%2Fgi%2C%2520%2522ao%25C3%25BBt%2522)%3B%250A%250A%2520%2520const%2520monthLookup%2520%3D%2520%257B%250A%2520%2520%2520%2520janvier%3A%2520%252201%2522%2C%250A%2520%2520%2520%2520fevrier%3A%2520%252202%2522%2C%250A%2520%2520%2520%2520mars%3A%2520%252203%2522%2C%250A%2520%2520%2520%2520avril%3A%2520%252204%2522%2C%250A%2520%2520%2520%2520mai%3A%2520%252205%2522%2C%250A%2520%2520%2520%2520juin%3A%2520%252206%2522%2C%250A%2520%2520%2520%2520juillet%3A%2520%252207%2522%2C%250A%2520%2520%2520%2520aout%3A%2520%252208%2522%2C%250A%2520%2520%2520%2520septembre%3A%2520%252209%2522%2C%250A%2520%2520%2520%2520octobre%3A%2520%252210%2522%2C%250A%2520%2520%2520%2520novembre%3A%2520%252211%2522%2C%250A%2520%2520%2520%2520decembre%3A%2520%252212%2522%2C%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520removeWeekday%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520weekdays%2520%3D%2520%255B%250A%2520%2520%2520%2520%2520%2520%2522lundi%2522%2C%250A%2520%2520%2520%2520%2520%2520%2522mardi%2522%2C%250A%2520%2520%2520%2520%2520%2520%2522mercredi%2522%2C%250A%2520%2520%2520%2520%2520%2520%2522jeudi%2522%2C%250A%2520%2520%2520%2520%2520%2520%2522vendredi%2522%2C%250A%2520%2520%2520%2520%2520%2520%2522samedi%2522%2C%250A%2520%2520%2520%2520%2520%2520%2522dimanche%2522%2C%250A%2520%2520%2520%2520%255D%3B%250A%2520%2520%2520%2520const%2520pattern%2520%3D%2520new%2520RegExp(%250A%2520%2520%2520%2520%2520%2520%2560%255E(%3F%3A%24%257Bweekdays.join(%2522%257C%2522)%257D)(%3F%3A%255B%255C%255Cs%255C%255Cu00a0%255C%255Cu202f%255C%255Cu2009%255C%255C.%2C%255D)%2B%2560%2C%250A%2520%2520%2520%2520%2520%2520%2522i%2522%250A%2520%2520%2520%2520)%3B%250A%2520%2520%2520%2520return%2520toStringSafe(value).replace(pattern%2C%2520%2522%2522)%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520normalizeMonthKey%2520%3D%2520(value)%2520%3D%253E%250A%2520%2520%2520%2520toStringSafe(value)%250A%2520%2520%2520%2520%2520%2520.toLowerCase()%250A%2520%2520%2520%2520%2520%2520.normalize(%2522NFD%2522)%250A%2520%2520%2520%2520%2520%2520.replace(%2F%255B%255Cu0300-%255Cu036f%255D%2Fg%2C%2520%2522%2522)%250A%2520%2520%2520%2520%2520%2520.replace(%2F%255B%255Ea-z%255D%2Fg%2C%2520%2522%2522)%3B%250A%250A%2520%2520const%2520getIata%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520matches%2520%3D%2520normalizeWhitespace(value).match(%2F%255Cb%255BA-Z%255D%257B3%257D%255Cb%2Fg)%3B%250A%2520%2520%2520%2520return%2520matches%2520%3F%2520matches%255Bmatches.length%2520-%25201%255D%2520%3A%2520null%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520getStationCode%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520match%2520%3D%2520toStringSafe(value).match(%2F-%255Cs*(%255Cd%257B4%2C5%257D)%255Cs*%24%2F)%3B%250A%2520%2520%2520%2520return%2520match%2520%3F%2520match%255B1%255D%2520%3A%2520null%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520getTime%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520text%2520%3D%2520toStringSafe(value)%3B%250A%2520%2520%2520%2520const%2520regex%2520%3D%2520%2F(%3F%3A%255E%257C%255B%255E0-9%255D)(%255Cd%257B1%2C2%257D)%255Cs*%255B%3Ah%255D%255Cs*(%255Cd%257B2%257D)(%3F!%255Cd)%2Fgi%3B%250A%2520%2520%2520%2520let%2520match%3B%250A%2520%2520%2520%2520let%2520lastMatch%2520%3D%2520null%3B%250A%2520%2520%2520%2520while%2520((match%2520%3D%2520regex.exec(text))%2520!%3D%3D%2520null)%2520%257B%250A%2520%2520%2520%2520%2520%2520lastMatch%2520%3D%2520match%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520if%2520(!lastMatch)%2520return%2520null%3B%250A%2520%2520%2520%2520const%2520hours%2520%3D%2520String(parseInt(lastMatch%255B1%255D%2C%252010)).padStart(2%2C%2520%25220%2522)%3B%250A%2520%2520%2520%2520const%2520minutes%2520%3D%2520String(parseInt(lastMatch%255B2%255D%2C%252010)).padStart(2%2C%2520%25220%2522)%3B%250A%2520%2520%2520%2520return%2520%2560%24%257Bhours%257D%3A%24%257Bminutes%257D%2560%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520getDate%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520cleaned%2520%3D%2520normalizeWhitespace(removeWeekday(fixAccents(value)))%3B%250A%2520%2520%2520%2520const%2520match%2520%3D%2520cleaned.match(%2F(%255Cd%257B1%2C2%257D)%255Cs%2B(%255Ba-z%25C3%25A0%25C3%25A2%25C3%25A7%25C3%25A9%25C3%25A8%25C3%25AA%25C3%25AB%25C3%25AE%25C3%25AF%25C3%25B4%25C3%25BB%25C3%25B9%25C3%25BC%25C3%25BF%25C3%25B1%25C3%25A6%25C5%2593%255D%2B)%255Cs%2B(%255Cd%257B4%257D)%2Fi)%3B%250A%2520%2520%2520%2520if%2520(!match)%2520return%2520null%3B%250A%2520%2520%2520%2520const%2520day%2520%3D%2520String(parseInt(match%255B1%255D%2C%252010)).padStart(2%2C%2520%25220%2522)%3B%250A%2520%2520%2520%2520const%2520monthKey%2520%3D%2520normalizeMonthKey(match%255B2%255D)%3B%250A%2520%2520%2520%2520const%2520month%2520%3D%2520monthLookup%255BmonthKey%255D%3B%250A%2520%2520%2520%2520if%2520(!month)%2520return%2520null%3B%250A%2520%2520%2520%2520return%2520%2560%24%257Bmatch%255B3%255D%257D-%24%257Bmonth%257D-%24%257Bday%257D%2560%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520getSectionData%2520%3D%2520(selector%2C%2520keyword)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520container%2520%3D%2520document.querySelector(%2522%2523infos%2522)%3B%250A%2520%2520%2520%2520if%2520(!container)%2520return%2520null%3B%250A%250A%2520%2520%2520%2520const%2520title%2520%3D%2520Array.from(container.querySelectorAll(selector)).find((node)%2520%3D%253E%250A%2520%2520%2520%2520%2520%2520normalizeWhitespace(node.textContent%2520%257C%257C%2520%2522%2522).toLowerCase().includes(keyword)%250A%2520%2520%2520%2520)%3B%250A%250A%2520%2520%2520%2520if%2520(!title)%2520return%2520null%3B%250A%250A%2520%2520%2520%2520const%2520findNextTxt%2520%3D%2520(node)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520let%2520current%2520%3D%2520node.nextElementSibling%3B%250A%2520%2520%2520%2520%2520%2520while%2520(current)%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%2520(current.classList%2520%26%26%2520current.classList.contains(%2522txt%2522))%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520return%2520current%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520%2520%2520%2520%2520current%2520%3D%2520current.nextElementSibling%3B%250A%2520%2520%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520%2520%2520return%2520null%3B%250A%2520%2520%2520%2520%257D%3B%250A%250A%2520%2520%2520%2520const%2520stationElement%2520%3D%2520findNextTxt(title)%3B%250A%2520%2520%2520%2520const%2520dateElement%2520%3D%2520stationElement%2520%3F%2520findNextTxt(stationElement)%2520%3A%2520null%3B%250A%250A%2520%2520%2520%2520const%2520stationLine%2520%3D%2520stationElement%2520%3F%2520stationElement.textContent%2520%3A%2520%2522%2522%3B%250A%2520%2520%2520%2520const%2520boldNode%2520%3D%2520stationElement%2520%3F%2520stationElement.querySelector(%2522b%2522)%2520%3A%2520null%3B%250A%2520%2520%2520%2520const%2520stationRaw%2520%3D%2520normalizeWhitespace(boldNode%2520%3F%2520boldNode.textContent%2520%3A%2520%2522%2522)%3B%250A%2520%2520%2520%2520const%2520stationCode%2520%3D%2520stationElement%2520%3F%2520getStationCode(normalizeWhitespace(stationLine))%2520%3A%2520null%3B%250A%2520%2520%2520%2520const%2520iata%2520%3D%2520stationRaw%2520%3F%2520getIata(stationRaw)%2520%3A%2520null%3B%250A%250A%2520%2520%2520%2520const%2520dateRaw%2520%3D%2520normalizeWhitespace(dateElement%2520%3F%2520dateElement.textContent%2520%3A%2520%2522%2522)%3B%250A%2520%2520%2520%2520const%2520time%2520%3D%2520dateRaw%2520%3F%2520getTime(dateRaw)%2520%3A%2520null%3B%250A%2520%2520%2520%2520const%2520date%2520%3D%2520dateRaw%2520%3F%2520getDate(dateRaw)%2520%3A%2520null%3B%250A%250A%2520%2520%2520%2520return%2520%257B%250A%2520%2520%2520%2520%2520%2520station%3A%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520raw%3A%2520stationRaw%2520%257C%257C%2520null%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520stationCode%3A%2520stationCode%2520%257C%257C%2520null%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520iata%2C%250A%2520%2520%2520%2520%2520%2520%257D%2C%250A%2520%2520%2520%2520%2520%2520datetime%3A%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520dateRaw%3A%2520dateRaw%2520%257C%257C%2520null%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520date%3A%2520date%2520%257C%257C%2520null%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520time%2C%250A%2520%2520%2520%2520%2520%2520%257D%2C%250A%2520%2520%2520%2520%257D%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520pickupData%2520%3D%2520getSectionData(%2522.tit%2522%2C%2520%2522prise%2522)%3B%250A%2520%2520const%2520returnData%2520%3D%2520getSectionData(%2522.tit.top1%2522%2C%2520%2522retour%2522)%3B%250A%250A%2520%2520const%2520result%2520%3D%2520%257B%250A%2520%2520%2520%2520pickupStation%3A%2520pickupData%250A%2520%2520%2520%2520%2520%2520%3F%2520pickupData.station%250A%2520%2520%2520%2520%2520%2520%3A%2520%257B%2520raw%3A%2520null%2C%2520stationCode%3A%2520null%2C%2520iata%3A%2520null%2520%257D%2C%250A%2520%2520%2520%2520pickup%3A%2520pickupData%250A%2520%2520%2520%2520%2520%2520%3F%2520pickupData.datetime%250A%2520%2520%2520%2520%2520%2520%3A%2520%257B%2520dateRaw%3A%2520null%2C%2520date%3A%2520null%2C%2520time%3A%2520null%2520%257D%2C%250A%2520%2520%2520%2520returnStation%3A%2520returnData%250A%2520%2520%2520%2520%2520%2520%3F%2520returnData.station%250A%2520%2520%2520%2520%2520%2520%3A%2520%257B%2520raw%3A%2520null%2C%2520stationCode%3A%2520null%2C%2520iata%3A%2520null%2520%257D%2C%250A%2520%2520%2520%2520return%3A%2520returnData%250A%2520%2520%2520%2520%2520%2520%3F%2520returnData.datetime%250A%2520%2520%2520%2520%2520%2520%3A%2520%257B%2520dateRaw%3A%2520null%2C%2520date%3A%2520null%2C%2520time%3A%2520null%2520%257D%2C%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520logStructuredResult%2520%3D%2520(data)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520if%2520(!data%2520%257C%257C%2520typeof%2520data%2520!%3D%3D%2520%2522object%2522)%2520%257B%250A%2520%2520%2520%2520%2520%2520console.warn(%2522bspAutoBookingData%2520is%2520empty%2520or%2520invalid%2522%2C%2520data)%3B%250A%2520%2520%2520%2520%2520%2520return%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520console.group(%2522bspAutoBookingData%2520(structured)%2522)%3B%250A%2520%2520%2520%2520%255B%250A%2520%2520%2520%2520%2520%2520%257B%2520title%3A%2520%2522Pickup%2520Station%2522%2C%2520value%3A%2520data.pickupStation%2520%257D%2C%250A%2520%2520%2520%2520%2520%2520%257B%2520title%3A%2520%2522Pickup%2520Date%2FTime%2522%2C%2520value%3A%2520data.pickup%2520%257D%2C%250A%2520%2520%2520%2520%2520%2520%257B%2520title%3A%2520%2522Return%2520Station%2522%2C%2520value%3A%2520data.returnStation%2520%257D%2C%250A%2520%2520%2520%2520%2520%2520%257B%2520title%3A%2520%2522Return%2520Date%2FTime%2522%2C%2520value%3A%2520data.return%2520%257D%2C%250A%2520%2520%2520%2520%255D.forEach((%257B%2520title%2C%2520value%2520%257D)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520console.group(title)%3B%250A%2520%2520%2520%2520%2520%2520if%2520(value%2520%26%26%2520typeof%2520value%2520%3D%3D%3D%2520%2522object%2522)%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520console.table(%255Bvalue%255D)%3B%250A%2520%2520%2520%2520%2520%2520%257D%2520else%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520console.log(value)%3B%250A%2520%2520%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520%2520%2520console.groupEnd()%3B%250A%2520%2520%2520%2520%257D)%3B%250A%2520%2520%2520%2520console.groupEnd()%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520hasNonNullValue%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520if%2520(Array.isArray(value))%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520value.some(hasNonNullValue)%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520if%2520(value%2520%26%26%2520typeof%2520value%2520%3D%3D%3D%2520%2522object%2522)%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520Object.values(value).some(hasNonNullValue)%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520return%2520value%2520!%3D%2520null%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520showToast%2520%3D%2520(message%2C%2520%257B%2520error%2520%3D%2520false%2520%257D%2520%3D%2520%257B%257D)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520existing%2520%3D%2520document.querySelector(%2522%2523bsp-auto-toast%2522)%3B%250A%2520%2520%2520%2520if%2520(existing)%2520%257B%250A%2520%2520%2520%2520%2520%2520existing.remove()%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520const%2520toast%2520%3D%2520document.createElement(%2522div%2522)%3B%250A%2520%2520%2520%2520toast.id%2520%3D%2520%2522bsp-auto-toast%2522%3B%250A%2520%2520%2520%2520toast.style.position%2520%3D%2520%2522fixed%2522%3B%250A%2520%2520%2520%2520toast.style.top%2520%3D%2520%252216px%2522%3B%250A%2520%2520%2520%2520toast.style.left%2520%3D%2520%252250%2525%2522%3B%250A%2520%2520%2520%2520toast.style.transform%2520%3D%2520%2522translateX(-50%2525)%2522%3B%250A%2520%2520%2520%2520toast.style.padding%2520%3D%2520%252210px%252016px%2522%3B%250A%2520%2520%2520%2520toast.style.background%2520%3D%2520error%2520%3F%2520%2522%2523e67e22%2522%2520%3A%2520%2522%25232ecc71%2522%3B%250A%2520%2520%2520%2520toast.style.color%2520%3D%2520%2522%2523fff%2522%3B%250A%2520%2520%2520%2520toast.style.font%2520%3D%2520%252214px%2F1.4%2520sans-serif%2522%3B%250A%2520%2520%2520%2520toast.style.borderRadius%2520%3D%2520%25224px%2522%3B%250A%2520%2520%2520%2520toast.style.boxShadow%2520%3D%2520%25220%25204px%252012px%2520rgba(0%2C%25200%2C%25200%2C%25200.15)%2522%3B%250A%2520%2520%2520%2520toast.style.zIndex%2520%3D%2520%25222147483647%2522%3B%250A%2520%2520%2520%2520toast.style.display%2520%3D%2520%2522flex%2522%3B%250A%2520%2520%2520%2520toast.style.alignItems%2520%3D%2520%2522center%2522%3B%250A%2520%2520%2520%2520toast.style.gap%2520%3D%2520%252212px%2522%3B%250A%250A%2520%2520%2520%2520const%2520label%2520%3D%2520document.createElement(%2522span%2522)%3B%250A%2520%2520%2520%2520label.textContent%2520%3D%2520message%3B%250A%2520%2520%2520%2520toast.appendChild(label)%3B%250A%250A%2520%2520%2520%2520document.body.appendChild(toast)%3B%250A%2520%2520%2520%2520setTimeout(()%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520toast.style.transition%2520%3D%2520%2522opacity%2520200ms%2520ease%2522%3B%250A%2520%2520%2520%2520%2520%2520toast.style.opacity%2520%3D%2520%25220%2522%3B%250A%2520%2520%2520%2520%2520%2520setTimeout(()%2520%3D%253E%2520toast.remove()%2C%2520220)%3B%250A%2520%2520%2520%2520%257D%2C%25204000)%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520if%2520(!hasNonNullValue(result))%2520%257B%250A%2520%2520%2520%2520console.warn(%2522No%2520BSP%2520data%2520found%2522%2C%2520result)%3B%250A%2520%2520%2520%2520showToast(%2522No%2520data%2520found%2522%2C%2520%257B%2520error%3A%2520true%2520%257D)%3B%250A%2520%2520%2520%2520return%3B%250A%2520%2520%257D%250A%250A%2520%2520try%2520%257B%250A%2520%2520%2520%2520localStorage.setItem(%2522bspAutoBookingData%2522%2C%2520JSON.stringify(result))%3B%250A%2520%2520%2520%2520console.info(%2522bspAutoBookingData%2520updated%2522%2C%2520result)%3B%250A%2520%2520%2520%2520logStructuredResult(result)%3B%250A%2520%2520%2520%2520showToast(%2522BSP%2520data%2520copied%2522)%3B%250A%2520%2520%2520%2520const%2520openPasteBookmarkletPage%2520%3D%2520()%2520%3D%253E%250A%2520%2520%2520%2520%2520%2520window.open(%250A%2520%2520%2520%2520%2520%2520%2520%2520%2522https%3A%2F%2Fwww.bsp-auto.com%2Fauto_2175bsp%2Ftarifs.asp%2522%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520%2522_blank%2522%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520%2522noopener%2522%250A%2520%2520%2520%2520%2520%2520)%3B%250A%2520%2520%2520%2520setTimeout(openPasteBookmarkletPage%2C%25201000)%3B%250A%2520%2520%257D%2520catch%2520(error)%2520%257B%250A%2520%2520%2520%2520console.error(%2522Failed%2520to%2520store%2520bspAutoBookingData%2522%2C%2520error%2C%2520result)%3B%250A%2520%2520%2520%2520showToast(%2522Failed%2520to%2520copy%2520BSP%2520data%2522%2C%2520%257B%2520error%3A%2520true%2520%257D)%3B%250A%2520%2520%257D%250A%257D)()%3B%250A%257D)()%3B" data-tip="Copy bookmarklet URL">ðŸ“‹ Copy</button>
      </div>
      <details><summary>More info</summary><div class="more">Kopiert strukturierte Daten in die Zwischenablage.</div></details>
    </article>
<article class="card" data-id="Fill Bookmarklet">
      <div class="row1">
        <div class="row1-left">
          <a class="btn" draggable="true" href="javascript:(function()%7Bjavascript:(async%20()%20=%3E%20%7B%0A%20%20const%20STORAGE_KEY%20=%20%22bspAutoBookingData%22;%0A%20%20const%20AUTOCOMPLETE_SELECTOR%20=%20%22.ui-autocomplete.ui-front%22;%0A%20%20const%20AUTOCOMPLETE_ITEM_SELECTOR%20=%0A%20%20%20%20%22li.ui-menu-item%20%3E%20.ui-menu-item-wrapper,%20.ui-menu-item-wrapper%22;%0A%0A%20%20const%20wait%20=%20(ms)%20=%3E%20new%20Promise((resolve)%20=%3E%20setTimeout(resolve,%20ms));%0A%0A%20%20const%20waitFor%20=%20async%20(predicate,%20%7B%20timeout%20=%204000,%20interval%20=%20100%20%7D%20=%20%7B%7D)%20=%3E%20%7B%0A%20%20%20%20const%20start%20=%20Date.now();%0A%20%20%20%20while%20(Date.now()%20-%20start%20%3C%20timeout)%20%7B%0A%20%20%20%20%20%20const%20result%20=%20await%20predicate();%0A%20%20%20%20%20%20if%20(result)%20return%20result;%0A%20%20%20%20%20%20await%20wait(interval);%0A%20%20%20%20%7D%0A%20%20%20%20return%20null;%0A%20%20%7D;%0A%0A%20%20const%20toStringSafe%20=%20(value)%20=%3E%20(value%20==%20null%20?%20%22%22%20:%20String(value));%0A%0A%20%20const%20normalizeText%20=%20(value)%20=%3E%20toStringSafe(value).trim();%0A%0A%20%20const%20normalizeForMatch%20=%20(value)%20=%3E%0A%20%20%20%20toStringSafe(value)%0A%20%20%20%20%20%20.normalize(%22NFD%22)%0A%20%20%20%20%20%20.replace(/%5B%5Cu0300-%5Cu036f%5D/g,%20%22%22)%0A%20%20%20%20%20%20.toLowerCase()%0A%20%20%20%20%20%20.replace(/%5Cs+/g,%20%22%20%22)%0A%20%20%20%20%20%20.trim();%0A%0A%20%20const%20isVisible%20=%20(element)%20=%3E%20%7B%0A%20%20%20%20if%20(!element)%20return%20false;%0A%20%20%20%20const%20style%20=%20window.getComputedStyle(element);%0A%20%20%20%20if%20(style.display%20===%20%22none%22%20%7C%7C%20style.visibility%20===%20%22hidden%22%20%7C%7C%20style.opacity%20===%20%220%22)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%20%20const%20rect%20=%20element.getBoundingClientRect();%0A%20%20%20%20return%20rect.width%20%3E%200%20&&%20rect.height%20%3E%200;%0A%20%20%7D;%0A%0A%20%20const%20typeText%20=%20async%20(element,%20text)%20=%3E%20%7B%0A%20%20%20%20const%20value%20=%20toStringSafe(text);%0A%20%20%20%20element.value%20=%20%22%22;%0A%20%20%20%20element.dispatchEvent(new%20Event(%22input%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20element.value%20=%20value;%0A%20%20%20%20element.dispatchEvent(new%20Event(%22input%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20element.dispatchEvent(new%20Event(%22change%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%7D;%0A%0A%20%20const%20collectOptions%20=%20(itemElements)%20=%3E%0A%20%20%20%20itemElements.map((el)%20=%3E%20(%7B%0A%20%20%20%20%20%20el,%0A%20%20%20%20%20%20label:%20normalizeText(el.getAttribute(%22data-label%22)%20%7C%7C%20el.textContent),%0A%20%20%20%20%7D));%0A%0A%20%20const%20showToast%20=%20(message,%20%7B%20error%20=%20false%20%7D%20=%20%7B%7D)%20=%3E%20%7B%0A%20%20%20%20const%20existing%20=%20document.querySelector(%22%23bsp-auto-toast%22);%0A%20%20%20%20if%20(existing)%20%7B%0A%20%20%20%20%20%20existing.remove();%0A%20%20%20%20%7D%0A%20%20%20%20const%20toast%20=%20document.createElement(%22div%22);%0A%20%20%20%20toast.id%20=%20%22bsp-auto-toast%22;%0A%20%20%20%20toast.style.position%20=%20%22fixed%22;%0A%20%20%20%20toast.style.top%20=%20%2216px%22;%0A%20%20%20%20toast.style.left%20=%20%2250%25%22;%0A%20%20%20%20toast.style.transform%20=%20%22translateX(-50%25)%22;%0A%20%20%20%20toast.style.padding%20=%20%2210px%2016px%22;%0A%20%20%20%20toast.style.background%20=%20error%20?%20%22%23e67e22%22%20:%20%22%232ecc71%22;%0A%20%20%20%20toast.style.color%20=%20%22%23fff%22;%0A%20%20%20%20toast.style.font%20=%20%2214px/1.4%20sans-serif%22;%0A%20%20%20%20toast.style.borderRadius%20=%20%224px%22;%0A%20%20%20%20toast.style.boxShadow%20=%20%220%204px%2012px%20rgba(0,%200,%200,%200.15)%22;%0A%20%20%20%20toast.style.zIndex%20=%20%222147483647%22;%0A%20%20%20%20toast.style.display%20=%20%22flex%22;%0A%20%20%20%20toast.style.alignItems%20=%20%22center%22;%0A%20%20%20%20toast.style.gap%20=%20%2212px%22;%0A%0A%20%20%20%20const%20label%20=%20document.createElement(%22span%22);%0A%20%20%20%20label.textContent%20=%20message;%0A%20%20%20%20toast.appendChild(label);%0A%0A%20%20%20%20document.body.appendChild(toast);%0A%20%20%20%20setTimeout(()%20=%3E%20%7B%0A%20%20%20%20%20%20toast.style.transition%20=%20%22opacity%20200ms%20ease%22;%0A%20%20%20%20%20%20toast.style.opacity%20=%20%220%22;%0A%20%20%20%20%20%20setTimeout(()%20=%3E%20toast.remove(),%20220);%0A%20%20%20%20%7D,%204000);%0A%20%20%7D;%0A%0A%20%20const%20parseStorage%20=%20()%20=%3E%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20const%20raw%20=%20localStorage.getItem(STORAGE_KEY);%0A%20%20%20%20%20%20if%20(!raw)%20return%20null;%0A%0A%20%20%20%20%20%20const%20parsed%20=%20JSON.parse(raw);%0A%0A%20%20%20%20%20%20const%20normalizeStation%20=%20(station)%20=%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20(!station)%20return%20null;%0A%20%20%20%20%20%20%20%20const%20rawValue%20=%20normalizeText(station.raw);%0A%20%20%20%20%20%20%20%20if%20(!rawValue)%20return%20null;%0A%0A%20%20%20%20%20%20%20%20const%20normalized%20=%20%7B%20raw:%20rawValue%20%7D;%0A%0A%20%20%20%20%20%20%20%20const%20stationCode%20=%20normalizeText(station.stationCode);%0A%20%20%20%20%20%20%20%20if%20(stationCode)%20%7B%0A%20%20%20%20%20%20%20%20%20%20normalized.stationCode%20=%20stationCode;%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20const%20iata%20=%20normalizeText(station.iata);%0A%20%20%20%20%20%20%20%20if%20(iata)%20%7B%0A%20%20%20%20%20%20%20%20%20%20normalized.iata%20=%20iata;%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20normalized;%0A%20%20%20%20%20%20%7D;%0A%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20...parsed,%0A%20%20%20%20%20%20%20%20pickupStation:%20normalizeStation(parsed.pickupStation),%0A%20%20%20%20%20%20%20%20returnStation:%20normalizeStation(parsed.returnStation),%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20%20%20return%20null;%0A%20%20%20%20%7D%0A%20%20%7D;%0A%0A%20%20const%20fillAutocomplete%20=%20async%20(%7B%20inputSelector,%20station%20%7D)%20=%3E%20%7B%0A%20%20%20%20const%20input%20=%20await%20waitFor(()%20=%3E%20document.querySelector(inputSelector));%0A%20%20%20%20if%20(!input)%20%7B%0A%20%20%20%20%20%20throw%20new%20Error(%22Feld%20nicht%20gefunden%22);%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20rawValue%20=%20toStringSafe(station?.raw);%0A%20%20%20%20if%20(!normalizeText(rawValue))%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20normalizedRaw%20=%20normalizeForMatch(rawValue);%0A%20%20%20%20const%20rawContainsAeroport%20=%20/aeroport/i.test(rawValue);%0A%20%20%20%20const%20fallbackIata%20=%20normalizeText(station?.iata);%0A%20%20%20%20const%20fallbackValue%20=%20rawContainsAeroport%20&&%20fallbackIata%0A%20%20%20%20%20%20?%20%60Aeroport%20$%7BfallbackIata%7D%60%0A%20%20%20%20%20%20:%20null;%0A%0A%20%20%20%20input.focus();%0A%20%20%20%20await%20wait(30);%0A%0A%20%20%20%20const%20findSuggestions%20=%20()%20=%3E%20%7B%0A%20%20%20%20%20%20const%20lists%20=%20Array.from(document.querySelectorAll(AUTOCOMPLETE_SELECTOR));%0A%20%20%20%20%20%20for%20(const%20list%20of%20lists)%20%7B%0A%20%20%20%20%20%20%20%20if%20(!isVisible(list))%20continue;%0A%20%20%20%20%20%20%20%20const%20found%20=%20Array.from(list.querySelectorAll(AUTOCOMPLETE_ITEM_SELECTOR));%0A%20%20%20%20%20%20%20%20if%20(found.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20found;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null;%0A%20%20%20%20%7D;%0A%0A%20%20%20%20const%20typeAndCollect%20=%20async%20(text)%20=%3E%20%7B%0A%20%20%20%20%20%20if%20(!normalizeText(text))%20return%20null;%0A%20%20%20%20%20%20input.focus();%0A%20%20%20%20%20%20await%20typeText(input,%20text);%0A%20%20%20%20%20%20await%20wait(150);%0A%20%20%20%20%20%20const%20collected%20=%20await%20waitFor(findSuggestions,%20%7B%20timeout:%201000,%20interval:%2080%20%7D);%0A%20%20%20%20%20%20return%20collected;%0A%20%20%20%20%7D;%0A%0A%20%20%20%20let%20items%20=%20await%20typeAndCollect(rawValue);%0A%0A%20%20%20%20if%20(!items%20&&%20fallbackValue)%20%7B%0A%20%20%20%20%20%20items%20=%20await%20typeAndCollect(fallbackValue);%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!items)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%20%20const%20options%20=%20collectOptions(items).map((option)%20=%3E%20(%7B%0A%20%20%20%20%20%20...option,%0A%20%20%20%20%20%20normalized:%20normalizeForMatch(option.label),%0A%20%20%20%20%7D));%0A%20%20%20%20if%20(!options.length)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20isExactMatch%20=%20(optionNormalized)%20=%3E%0A%20%20%20%20%20%20optionNormalized%20===%20normalizedRaw%20%7C%7C%20optionNormalized.includes(normalizedRaw);%0A%20%20%20%20let%20candidate%20=%20options.find((option)%20=%3E%20isExactMatch(option.normalized));%0A%20%20%20%20if%20(!candidate)%20%7B%0A%20%20%20%20%20%20candidate%20=%20options%5B0%5D;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!candidate)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20target%20=%20candidate.el;%0A%20%20%20%20if%20(typeof%20target.scrollIntoView%20===%20%22function%22)%20%7B%0A%20%20%20%20%20%20target.scrollIntoView(%7B%20block:%20%22nearest%22%20%7D);%0A%20%20%20%20%7D%0A%0A%20%20%20%20%5B%22mouseover%22,%20%22mousedown%22,%20%22mouseup%22,%20%22click%22%5D.forEach((type)%20=%3E%20%7B%0A%20%20%20%20%20%20target.dispatchEvent(new%20MouseEvent(type,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20%7D);%0A%0A%20%20%20%20await%20wait(80);%0A%20%20%20%20return%20true;%0A%20%20%7D;%0A%0A%20%20const%20formatIsoDateToFr%20=%20(isoDate)%20=%3E%20%7B%0A%20%20%20%20const%20targetDate%20=%20new%20Date(%60$%7BisoDate%7DT00:00:00%60);%0A%20%20%20%20if%20(Number.isNaN(targetDate.getTime()))%20%7B%0A%20%20%20%20%20%20throw%20new%20Error(%22Ung%C3%BCltiges%20Datum%22);%0A%20%20%20%20%7D%0A%20%20%20%20const%20day%20=%20String(targetDate.getDate()).padStart(2,%20%220%22);%0A%20%20%20%20const%20month%20=%20String(targetDate.getMonth()%20+%201).padStart(2,%20%220%22);%0A%20%20%20%20const%20year%20=%20targetDate.getFullYear();%0A%20%20%20%20return%20%60$%7Bday%7D/$%7Bmonth%7D/$%7Byear%7D%60;%0A%20%20%7D;%0A%0A%20%20const%20setDate%20=%20async%20(selector,%20isoDate)%20=%3E%20%7B%0A%20%20%20%20if%20(!isoDate)%20return;%0A%20%20%20%20const%20input%20=%20await%20waitFor(()%20=%3E%20document.querySelector(selector));%0A%20%20%20%20if%20(!input)%20throw%20new%20Error(%22Datumfeld%20fehlt%22);%0A%20%20%20%20const%20formatted%20=%20formatIsoDateToFr(isoDate);%0A%20%20%20%20input.value%20=%20formatted;%0A%20%20%20%20input.dispatchEvent(new%20Event(%22input%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20input.dispatchEvent(new%20Event(%22change%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%7D;%0A%0A%20%20const%20timeToMinutes%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20match%20=%20toStringSafe(value).match(/%5E(%5Cd%7B1,2%7D):(%5Cd%7B2%7D)$/);%0A%20%20%20%20if%20(!match)%20return%20null;%0A%20%20%20%20return%20parseInt(match%5B1%5D,%2010)%20*%2060%20+%20parseInt(match%5B2%5D,%2010);%0A%20%20%7D;%0A%0A%20%20const%20setTime%20=%20async%20(selector,%20timeValue)%20=%3E%20%7B%0A%20%20%20%20if%20(!timeValue)%20return;%0A%20%20%20%20const%20select%20=%20await%20waitFor(()%20=%3E%20document.querySelector(selector));%0A%20%20%20%20if%20(!select)%20throw%20new%20Error(%22Zeitfeld%20fehlt%22);%0A%20%20%20%20const%20targetMinutes%20=%20timeToMinutes(timeValue);%0A%20%20%20%20const%20options%20=%20Array.from(select.options).filter((option)%20=%3E%20option.value);%0A%20%20%20%20if%20(!options.length)%20throw%20new%20Error(%22Keine%20Zeitoptionen%22);%0A%0A%20%20%20%20const%20sorted%20=%20options%0A%20%20%20%20%20%20.map((option)%20=%3E%20(%7B%20option,%20minutes:%20timeToMinutes(option.value)%20%7D))%0A%20%20%20%20%20%20.filter((%7B%20minutes%20%7D)%20=%3E%20minutes%20!=%20null)%0A%20%20%20%20%20%20.sort((a,%20b)%20=%3E%20a.minutes%20-%20b.minutes);%0A%0A%20%20%20%20let%20chosen%20=%20sorted.find((%7B%20minutes%20%7D)%20=%3E%20minutes%20%3E=%20targetMinutes);%0A%20%20%20%20if%20(!chosen)%20%7B%0A%20%20%20%20%20%20chosen%20=%20sorted%5Bsorted.length%20-%201%5D;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!chosen)%20throw%20new%20Error(%22Zeit%20nicht%20verf%C3%BCgbar%22);%0A%0A%20%20%20%20select.value%20=%20chosen.option.value;%0A%20%20%20%20select.dispatchEvent(new%20Event(%22change%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%7D;%0A%0A%20%20const%20data%20=%20parseStorage();%0A%20%20if%20(!data)%20%7B%0A%20%20%20%20showToast(%22Keine%20Daten.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20return;%0A%20%20%7D%0A%0A%20%20try%20%7B%0A%20%20%20%20const%20pickupSuccess%20=%20await%20fillAutocomplete(%7B%0A%20%20%20%20%20%20inputSelector:%20%22%23recherche-start%22,%0A%20%20%20%20%20%20station:%20data.pickupStation,%0A%20%20%20%20%7D);%0A%20%20%20%20if%20(!pickupSuccess)%20%7B%0A%20%20%20%20%20%20showToast(%22Startstation%20konnte%20nicht%20ausgew%C3%A4hlt%20werden.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20returnSuccess%20=%20await%20fillAutocomplete(%7B%0A%20%20%20%20%20%20inputSelector:%20%22%23recherche-end%22,%0A%20%20%20%20%20%20station:%20data.returnStation,%0A%20%20%20%20%7D);%0A%20%20%20%20if%20(!returnSuccess)%20%7B%0A%20%20%20%20%20%20showToast(%22R%C3%BCckgabestation%20konnte%20nicht%20ausgew%C3%A4hlt%20werden.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%0A%20%20%20%20await%20setDate(%22%23from%22,%20data.pickup?.date);%0A%20%20%20%20await%20setDate(%22%23to%22,%20data.return?.date);%0A%0A%20%20%20%20await%20setTime('select%5Bname=%22heure_a%22%5D',%20data.pickup?.time);%0A%20%20%20%20await%20setTime('select%5Bname=%22heure_d%22%5D',%20data.return?.time);%0A%0A%20%20%20%20showToast(%22Formular%20ausgef%C3%BCllt.%22);%0A%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20showToast(%22Fehler%20beim%20Ausf%C3%BCllen%20des%20Formulars.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%7D%0A%7D)();%0A%7D)();" data-tip="Drag to bookmarks">ðŸ”– Fill â€“ BSP Tarifs</a>
          <span class="name">Fill Bookmarklet</span>
        </div>
        <span class="badge">Last update: 29/10/2025</span>
      </div>
      <div class="actions">
        <button class="copy" type="button" data-code="javascript%3A(function()%257Bjavascript%3A(async%2520()%2520%3D%253E%2520%257B%250A%2520%2520const%2520STORAGE_KEY%2520%3D%2520%2522bspAutoBookingData%2522%3B%250A%2520%2520const%2520AUTOCOMPLETE_SELECTOR%2520%3D%2520%2522.ui-autocomplete.ui-front%2522%3B%250A%2520%2520const%2520AUTOCOMPLETE_ITEM_SELECTOR%2520%3D%250A%2520%2520%2520%2520%2522li.ui-menu-item%2520%253E%2520.ui-menu-item-wrapper%2C%2520.ui-menu-item-wrapper%2522%3B%250A%250A%2520%2520const%2520wait%2520%3D%2520(ms)%2520%3D%253E%2520new%2520Promise((resolve)%2520%3D%253E%2520setTimeout(resolve%2C%2520ms))%3B%250A%250A%2520%2520const%2520waitFor%2520%3D%2520async%2520(predicate%2C%2520%257B%2520timeout%2520%3D%25204000%2C%2520interval%2520%3D%2520100%2520%257D%2520%3D%2520%257B%257D)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520start%2520%3D%2520Date.now()%3B%250A%2520%2520%2520%2520while%2520(Date.now()%2520-%2520start%2520%253C%2520timeout)%2520%257B%250A%2520%2520%2520%2520%2520%2520const%2520result%2520%3D%2520await%2520predicate()%3B%250A%2520%2520%2520%2520%2520%2520if%2520(result)%2520return%2520result%3B%250A%2520%2520%2520%2520%2520%2520await%2520wait(interval)%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520return%2520null%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520toStringSafe%2520%3D%2520(value)%2520%3D%253E%2520(value%2520%3D%3D%2520null%2520%3F%2520%2522%2522%2520%3A%2520String(value))%3B%250A%250A%2520%2520const%2520normalizeText%2520%3D%2520(value)%2520%3D%253E%2520toStringSafe(value).trim()%3B%250A%250A%2520%2520const%2520normalizeForMatch%2520%3D%2520(value)%2520%3D%253E%250A%2520%2520%2520%2520toStringSafe(value)%250A%2520%2520%2520%2520%2520%2520.normalize(%2522NFD%2522)%250A%2520%2520%2520%2520%2520%2520.replace(%2F%255B%255Cu0300-%255Cu036f%255D%2Fg%2C%2520%2522%2522)%250A%2520%2520%2520%2520%2520%2520.toLowerCase()%250A%2520%2520%2520%2520%2520%2520.replace(%2F%255Cs%2B%2Fg%2C%2520%2522%2520%2522)%250A%2520%2520%2520%2520%2520%2520.trim()%3B%250A%250A%2520%2520const%2520isVisible%2520%3D%2520(element)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520if%2520(!element)%2520return%2520false%3B%250A%2520%2520%2520%2520const%2520style%2520%3D%2520window.getComputedStyle(element)%3B%250A%2520%2520%2520%2520if%2520(style.display%2520%3D%3D%3D%2520%2522none%2522%2520%257C%257C%2520style.visibility%2520%3D%3D%3D%2520%2522hidden%2522%2520%257C%257C%2520style.opacity%2520%3D%3D%3D%2520%25220%2522)%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520false%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520const%2520rect%2520%3D%2520element.getBoundingClientRect()%3B%250A%2520%2520%2520%2520return%2520rect.width%2520%253E%25200%2520%26%26%2520rect.height%2520%253E%25200%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520typeText%2520%3D%2520async%2520(element%2C%2520text)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520value%2520%3D%2520toStringSafe(text)%3B%250A%2520%2520%2520%2520element.value%2520%3D%2520%2522%2522%3B%250A%2520%2520%2520%2520element.dispatchEvent(new%2520Event(%2522input%2522%2C%2520%257B%2520bubbles%3A%2520true%2520%257D))%3B%250A%2520%2520%2520%2520element.value%2520%3D%2520value%3B%250A%2520%2520%2520%2520element.dispatchEvent(new%2520Event(%2522input%2522%2C%2520%257B%2520bubbles%3A%2520true%2520%257D))%3B%250A%2520%2520%2520%2520element.dispatchEvent(new%2520Event(%2522change%2522%2C%2520%257B%2520bubbles%3A%2520true%2520%257D))%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520collectOptions%2520%3D%2520(itemElements)%2520%3D%253E%250A%2520%2520%2520%2520itemElements.map((el)%2520%3D%253E%2520(%257B%250A%2520%2520%2520%2520%2520%2520el%2C%250A%2520%2520%2520%2520%2520%2520label%3A%2520normalizeText(el.getAttribute(%2522data-label%2522)%2520%257C%257C%2520el.textContent)%2C%250A%2520%2520%2520%2520%257D))%3B%250A%250A%2520%2520const%2520showToast%2520%3D%2520(message%2C%2520%257B%2520error%2520%3D%2520false%2520%257D%2520%3D%2520%257B%257D)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520existing%2520%3D%2520document.querySelector(%2522%2523bsp-auto-toast%2522)%3B%250A%2520%2520%2520%2520if%2520(existing)%2520%257B%250A%2520%2520%2520%2520%2520%2520existing.remove()%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520const%2520toast%2520%3D%2520document.createElement(%2522div%2522)%3B%250A%2520%2520%2520%2520toast.id%2520%3D%2520%2522bsp-auto-toast%2522%3B%250A%2520%2520%2520%2520toast.style.position%2520%3D%2520%2522fixed%2522%3B%250A%2520%2520%2520%2520toast.style.top%2520%3D%2520%252216px%2522%3B%250A%2520%2520%2520%2520toast.style.left%2520%3D%2520%252250%2525%2522%3B%250A%2520%2520%2520%2520toast.style.transform%2520%3D%2520%2522translateX(-50%2525)%2522%3B%250A%2520%2520%2520%2520toast.style.padding%2520%3D%2520%252210px%252016px%2522%3B%250A%2520%2520%2520%2520toast.style.background%2520%3D%2520error%2520%3F%2520%2522%2523e67e22%2522%2520%3A%2520%2522%25232ecc71%2522%3B%250A%2520%2520%2520%2520toast.style.color%2520%3D%2520%2522%2523fff%2522%3B%250A%2520%2520%2520%2520toast.style.font%2520%3D%2520%252214px%2F1.4%2520sans-serif%2522%3B%250A%2520%2520%2520%2520toast.style.borderRadius%2520%3D%2520%25224px%2522%3B%250A%2520%2520%2520%2520toast.style.boxShadow%2520%3D%2520%25220%25204px%252012px%2520rgba(0%2C%25200%2C%25200%2C%25200.15)%2522%3B%250A%2520%2520%2520%2520toast.style.zIndex%2520%3D%2520%25222147483647%2522%3B%250A%2520%2520%2520%2520toast.style.display%2520%3D%2520%2522flex%2522%3B%250A%2520%2520%2520%2520toast.style.alignItems%2520%3D%2520%2522center%2522%3B%250A%2520%2520%2520%2520toast.style.gap%2520%3D%2520%252212px%2522%3B%250A%250A%2520%2520%2520%2520const%2520label%2520%3D%2520document.createElement(%2522span%2522)%3B%250A%2520%2520%2520%2520label.textContent%2520%3D%2520message%3B%250A%2520%2520%2520%2520toast.appendChild(label)%3B%250A%250A%2520%2520%2520%2520document.body.appendChild(toast)%3B%250A%2520%2520%2520%2520setTimeout(()%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520toast.style.transition%2520%3D%2520%2522opacity%2520200ms%2520ease%2522%3B%250A%2520%2520%2520%2520%2520%2520toast.style.opacity%2520%3D%2520%25220%2522%3B%250A%2520%2520%2520%2520%2520%2520setTimeout(()%2520%3D%253E%2520toast.remove()%2C%2520220)%3B%250A%2520%2520%2520%2520%257D%2C%25204000)%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520parseStorage%2520%3D%2520()%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520try%2520%257B%250A%2520%2520%2520%2520%2520%2520const%2520raw%2520%3D%2520localStorage.getItem(STORAGE_KEY)%3B%250A%2520%2520%2520%2520%2520%2520if%2520(!raw)%2520return%2520null%3B%250A%250A%2520%2520%2520%2520%2520%2520const%2520parsed%2520%3D%2520JSON.parse(raw)%3B%250A%250A%2520%2520%2520%2520%2520%2520const%2520normalizeStation%2520%3D%2520(station)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%2520(!station)%2520return%2520null%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520const%2520rawValue%2520%3D%2520normalizeText(station.raw)%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%2520(!rawValue)%2520return%2520null%3B%250A%250A%2520%2520%2520%2520%2520%2520%2520%2520const%2520normalized%2520%3D%2520%257B%2520raw%3A%2520rawValue%2520%257D%3B%250A%250A%2520%2520%2520%2520%2520%2520%2520%2520const%2520stationCode%2520%3D%2520normalizeText(station.stationCode)%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%2520(stationCode)%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520normalized.stationCode%2520%3D%2520stationCode%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520%2520%2520%2520%2520const%2520iata%2520%3D%2520normalizeText(station.iata)%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%2520(iata)%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520normalized.iata%2520%3D%2520iata%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520%2520%2520%2520%2520return%2520normalized%3B%250A%2520%2520%2520%2520%2520%2520%257D%3B%250A%250A%2520%2520%2520%2520%2520%2520return%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520...parsed%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520pickupStation%3A%2520normalizeStation(parsed.pickupStation)%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520returnStation%3A%2520normalizeStation(parsed.returnStation)%2C%250A%2520%2520%2520%2520%2520%2520%257D%3B%250A%2520%2520%2520%2520%257D%2520catch%2520(error)%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520null%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520fillAutocomplete%2520%3D%2520async%2520(%257B%2520inputSelector%2C%2520station%2520%257D)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520input%2520%3D%2520await%2520waitFor(()%2520%3D%253E%2520document.querySelector(inputSelector))%3B%250A%2520%2520%2520%2520if%2520(!input)%2520%257B%250A%2520%2520%2520%2520%2520%2520throw%2520new%2520Error(%2522Feld%2520nicht%2520gefunden%2522)%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520const%2520rawValue%2520%3D%2520toStringSafe(station%3F.raw)%3B%250A%2520%2520%2520%2520if%2520(!normalizeText(rawValue))%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520false%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520const%2520normalizedRaw%2520%3D%2520normalizeForMatch(rawValue)%3B%250A%2520%2520%2520%2520const%2520rawContainsAeroport%2520%3D%2520%2Faeroport%2Fi.test(rawValue)%3B%250A%2520%2520%2520%2520const%2520fallbackIata%2520%3D%2520normalizeText(station%3F.iata)%3B%250A%2520%2520%2520%2520const%2520fallbackValue%2520%3D%2520rawContainsAeroport%2520%26%26%2520fallbackIata%250A%2520%2520%2520%2520%2520%2520%3F%2520%2560Aeroport%2520%24%257BfallbackIata%257D%2560%250A%2520%2520%2520%2520%2520%2520%3A%2520null%3B%250A%250A%2520%2520%2520%2520input.focus()%3B%250A%2520%2520%2520%2520await%2520wait(30)%3B%250A%250A%2520%2520%2520%2520const%2520findSuggestions%2520%3D%2520()%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520const%2520lists%2520%3D%2520Array.from(document.querySelectorAll(AUTOCOMPLETE_SELECTOR))%3B%250A%2520%2520%2520%2520%2520%2520for%2520(const%2520list%2520of%2520lists)%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%2520(!isVisible(list))%2520continue%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520const%2520found%2520%3D%2520Array.from(list.querySelectorAll(AUTOCOMPLETE_ITEM_SELECTOR))%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%2520(found.length)%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520return%2520found%3B%250A%2520%2520%2520%2520%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520%2520%2520return%2520null%3B%250A%2520%2520%2520%2520%257D%3B%250A%250A%2520%2520%2520%2520const%2520typeAndCollect%2520%3D%2520async%2520(text)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520if%2520(!normalizeText(text))%2520return%2520null%3B%250A%2520%2520%2520%2520%2520%2520input.focus()%3B%250A%2520%2520%2520%2520%2520%2520await%2520typeText(input%2C%2520text)%3B%250A%2520%2520%2520%2520%2520%2520await%2520wait(150)%3B%250A%2520%2520%2520%2520%2520%2520const%2520collected%2520%3D%2520await%2520waitFor(findSuggestions%2C%2520%257B%2520timeout%3A%25201000%2C%2520interval%3A%252080%2520%257D)%3B%250A%2520%2520%2520%2520%2520%2520return%2520collected%3B%250A%2520%2520%2520%2520%257D%3B%250A%250A%2520%2520%2520%2520let%2520items%2520%3D%2520await%2520typeAndCollect(rawValue)%3B%250A%250A%2520%2520%2520%2520if%2520(!items%2520%26%26%2520fallbackValue)%2520%257B%250A%2520%2520%2520%2520%2520%2520items%2520%3D%2520await%2520typeAndCollect(fallbackValue)%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520if%2520(!items)%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520false%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520const%2520options%2520%3D%2520collectOptions(items).map((option)%2520%3D%253E%2520(%257B%250A%2520%2520%2520%2520%2520%2520...option%2C%250A%2520%2520%2520%2520%2520%2520normalized%3A%2520normalizeForMatch(option.label)%2C%250A%2520%2520%2520%2520%257D))%3B%250A%2520%2520%2520%2520if%2520(!options.length)%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520false%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520const%2520isExactMatch%2520%3D%2520(optionNormalized)%2520%3D%253E%250A%2520%2520%2520%2520%2520%2520optionNormalized%2520%3D%3D%3D%2520normalizedRaw%2520%257C%257C%2520optionNormalized.includes(normalizedRaw)%3B%250A%2520%2520%2520%2520let%2520candidate%2520%3D%2520options.find((option)%2520%3D%253E%2520isExactMatch(option.normalized))%3B%250A%2520%2520%2520%2520if%2520(!candidate)%2520%257B%250A%2520%2520%2520%2520%2520%2520candidate%2520%3D%2520options%255B0%255D%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520if%2520(!candidate)%2520%257B%250A%2520%2520%2520%2520%2520%2520return%2520false%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520const%2520target%2520%3D%2520candidate.el%3B%250A%2520%2520%2520%2520if%2520(typeof%2520target.scrollIntoView%2520%3D%3D%3D%2520%2522function%2522)%2520%257B%250A%2520%2520%2520%2520%2520%2520target.scrollIntoView(%257B%2520block%3A%2520%2522nearest%2522%2520%257D)%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520%255B%2522mouseover%2522%2C%2520%2522mousedown%2522%2C%2520%2522mouseup%2522%2C%2520%2522click%2522%255D.forEach((type)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520%2520%2520target.dispatchEvent(new%2520MouseEvent(type%2C%2520%257B%2520bubbles%3A%2520true%2520%257D))%3B%250A%2520%2520%2520%2520%257D)%3B%250A%250A%2520%2520%2520%2520await%2520wait(80)%3B%250A%2520%2520%2520%2520return%2520true%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520formatIsoDateToFr%2520%3D%2520(isoDate)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520targetDate%2520%3D%2520new%2520Date(%2560%24%257BisoDate%257DT00%3A00%3A00%2560)%3B%250A%2520%2520%2520%2520if%2520(Number.isNaN(targetDate.getTime()))%2520%257B%250A%2520%2520%2520%2520%2520%2520throw%2520new%2520Error(%2522Ung%25C3%25BCltiges%2520Datum%2522)%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520const%2520day%2520%3D%2520String(targetDate.getDate()).padStart(2%2C%2520%25220%2522)%3B%250A%2520%2520%2520%2520const%2520month%2520%3D%2520String(targetDate.getMonth()%2520%2B%25201).padStart(2%2C%2520%25220%2522)%3B%250A%2520%2520%2520%2520const%2520year%2520%3D%2520targetDate.getFullYear()%3B%250A%2520%2520%2520%2520return%2520%2560%24%257Bday%257D%2F%24%257Bmonth%257D%2F%24%257Byear%257D%2560%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520setDate%2520%3D%2520async%2520(selector%2C%2520isoDate)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520if%2520(!isoDate)%2520return%3B%250A%2520%2520%2520%2520const%2520input%2520%3D%2520await%2520waitFor(()%2520%3D%253E%2520document.querySelector(selector))%3B%250A%2520%2520%2520%2520if%2520(!input)%2520throw%2520new%2520Error(%2522Datumfeld%2520fehlt%2522)%3B%250A%2520%2520%2520%2520const%2520formatted%2520%3D%2520formatIsoDateToFr(isoDate)%3B%250A%2520%2520%2520%2520input.value%2520%3D%2520formatted%3B%250A%2520%2520%2520%2520input.dispatchEvent(new%2520Event(%2522input%2522%2C%2520%257B%2520bubbles%3A%2520true%2520%257D))%3B%250A%2520%2520%2520%2520input.dispatchEvent(new%2520Event(%2522change%2522%2C%2520%257B%2520bubbles%3A%2520true%2520%257D))%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520timeToMinutes%2520%3D%2520(value)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520const%2520match%2520%3D%2520toStringSafe(value).match(%2F%255E(%255Cd%257B1%2C2%257D)%3A(%255Cd%257B2%257D)%24%2F)%3B%250A%2520%2520%2520%2520if%2520(!match)%2520return%2520null%3B%250A%2520%2520%2520%2520return%2520parseInt(match%255B1%255D%2C%252010)%2520*%252060%2520%2B%2520parseInt(match%255B2%255D%2C%252010)%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520setTime%2520%3D%2520async%2520(selector%2C%2520timeValue)%2520%3D%253E%2520%257B%250A%2520%2520%2520%2520if%2520(!timeValue)%2520return%3B%250A%2520%2520%2520%2520const%2520select%2520%3D%2520await%2520waitFor(()%2520%3D%253E%2520document.querySelector(selector))%3B%250A%2520%2520%2520%2520if%2520(!select)%2520throw%2520new%2520Error(%2522Zeitfeld%2520fehlt%2522)%3B%250A%2520%2520%2520%2520const%2520targetMinutes%2520%3D%2520timeToMinutes(timeValue)%3B%250A%2520%2520%2520%2520const%2520options%2520%3D%2520Array.from(select.options).filter((option)%2520%3D%253E%2520option.value)%3B%250A%2520%2520%2520%2520if%2520(!options.length)%2520throw%2520new%2520Error(%2522Keine%2520Zeitoptionen%2522)%3B%250A%250A%2520%2520%2520%2520const%2520sorted%2520%3D%2520options%250A%2520%2520%2520%2520%2520%2520.map((option)%2520%3D%253E%2520(%257B%2520option%2C%2520minutes%3A%2520timeToMinutes(option.value)%2520%257D))%250A%2520%2520%2520%2520%2520%2520.filter((%257B%2520minutes%2520%257D)%2520%3D%253E%2520minutes%2520!%3D%2520null)%250A%2520%2520%2520%2520%2520%2520.sort((a%2C%2520b)%2520%3D%253E%2520a.minutes%2520-%2520b.minutes)%3B%250A%250A%2520%2520%2520%2520let%2520chosen%2520%3D%2520sorted.find((%257B%2520minutes%2520%257D)%2520%3D%253E%2520minutes%2520%253E%3D%2520targetMinutes)%3B%250A%2520%2520%2520%2520if%2520(!chosen)%2520%257B%250A%2520%2520%2520%2520%2520%2520chosen%2520%3D%2520sorted%255Bsorted.length%2520-%25201%255D%3B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520if%2520(!chosen)%2520throw%2520new%2520Error(%2522Zeit%2520nicht%2520verf%25C3%25BCgbar%2522)%3B%250A%250A%2520%2520%2520%2520select.value%2520%3D%2520chosen.option.value%3B%250A%2520%2520%2520%2520select.dispatchEvent(new%2520Event(%2522change%2522%2C%2520%257B%2520bubbles%3A%2520true%2520%257D))%3B%250A%2520%2520%257D%3B%250A%250A%2520%2520const%2520data%2520%3D%2520parseStorage()%3B%250A%2520%2520if%2520(!data)%2520%257B%250A%2520%2520%2520%2520showToast(%2522Keine%2520Daten.%2522%2C%2520%257B%2520error%3A%2520true%2520%257D)%3B%250A%2520%2520%2520%2520return%3B%250A%2520%2520%257D%250A%250A%2520%2520try%2520%257B%250A%2520%2520%2520%2520const%2520pickupSuccess%2520%3D%2520await%2520fillAutocomplete(%257B%250A%2520%2520%2520%2520%2520%2520inputSelector%3A%2520%2522%2523recherche-start%2522%2C%250A%2520%2520%2520%2520%2520%2520station%3A%2520data.pickupStation%2C%250A%2520%2520%2520%2520%257D)%3B%250A%2520%2520%2520%2520if%2520(!pickupSuccess)%2520%257B%250A%2520%2520%2520%2520%2520%2520showToast(%2522Startstation%2520konnte%2520nicht%2520ausgew%25C3%25A4hlt%2520werden.%2522%2C%2520%257B%2520error%3A%2520true%2520%257D)%3B%250A%2520%2520%2520%2520%2520%2520return%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520const%2520returnSuccess%2520%3D%2520await%2520fillAutocomplete(%257B%250A%2520%2520%2520%2520%2520%2520inputSelector%3A%2520%2522%2523recherche-end%2522%2C%250A%2520%2520%2520%2520%2520%2520station%3A%2520data.returnStation%2C%250A%2520%2520%2520%2520%257D)%3B%250A%2520%2520%2520%2520if%2520(!returnSuccess)%2520%257B%250A%2520%2520%2520%2520%2520%2520showToast(%2522R%25C3%25BCckgabestation%2520konnte%2520nicht%2520ausgew%25C3%25A4hlt%2520werden.%2522%2C%2520%257B%2520error%3A%2520true%2520%257D)%3B%250A%2520%2520%2520%2520%2520%2520return%3B%250A%2520%2520%2520%2520%257D%250A%250A%2520%2520%2520%2520await%2520setDate(%2522%2523from%2522%2C%2520data.pickup%3F.date)%3B%250A%2520%2520%2520%2520await%2520setDate(%2522%2523to%2522%2C%2520data.return%3F.date)%3B%250A%250A%2520%2520%2520%2520await%2520setTime('select%255Bname%3D%2522heure_a%2522%255D'%2C%2520data.pickup%3F.time)%3B%250A%2520%2520%2520%2520await%2520setTime('select%255Bname%3D%2522heure_d%2522%255D'%2C%2520data.return%3F.time)%3B%250A%250A%2520%2520%2520%2520showToast(%2522Formular%2520ausgef%25C3%25BCllt.%2522)%3B%250A%2520%2520%257D%2520catch%2520(error)%2520%257B%250A%2520%2520%2520%2520showToast(%2522Fehler%2520beim%2520Ausf%25C3%25BCllen%2520des%2520Formulars.%2522%2C%2520%257B%2520error%3A%2520true%2520%257D)%3B%250A%2520%2520%257D%250A%257D)()%3B%250A%257D)()%3B" data-tip="Copy bookmarklet URL">ðŸ“‹ Copy</button>
      </div>
      <details><summary>More info</summary><div class="more">FÃ¼llt das BSP-Formular automatisch.</div></details>
    </article>
      </section>
    </main>
  </div>
  <script>(function(){
  const root=document.documentElement;
  const body=document.body;
  const themeBtn=document.getElementById('themeToggle');
  const liveRegion=document.getElementById('liveRegion');
  const prefersDark=window.matchMedia?window.matchMedia('(prefers-color-scheme: dark)'):{matches:false};
  const PULSE_TIMEOUT=1200;
  const tipTimers=new WeakMap();
  let liveMessageTimer=null;
  let liveResetTimer=null;

  function safeGet(key){
    try{return localStorage.getItem(key);}catch(e){return null;}
  }

  function safeSet(key,value){
    try{localStorage.setItem(key,value);}catch(e){}
  }

  function updateThemeToggle(mode){
    if(!themeBtn) return;
    themeBtn.setAttribute('aria-pressed',mode==='dark'?'true':'false');
    const nextLabel=mode==='dark'?'Switch to light mode':'Switch to dark mode';
    themeBtn.setAttribute('data-tip',nextLabel);
    themeBtn.setAttribute('aria-label',nextLabel);
  }

  function applyTheme(mode,options){
    const chosen=mode==='dark'?'dark':'light';
    root.setAttribute('data-theme',chosen);
    if(body){body.setAttribute('data-theme',chosen);}
    if(!options||options.store!==false){
      safeSet('theme',chosen);
    }
    updateThemeToggle(chosen);
  }

  const saved=safeGet('theme');
  const initial=saved==='dark'||saved==='light'?saved:prefersDark.matches?'dark':'light';
  applyTheme(initial,{store:false});

  if(themeBtn){
    themeBtn.addEventListener('click',()=>{
      const current=root.getAttribute('data-theme')==='dark'?'dark':'light';
      const next=current==='dark'?'light':'dark';
      applyTheme(next);
    });
  }

  document.querySelectorAll('a.btn').forEach(anchor=>{
    anchor.addEventListener('dragstart',ev=>{
      const url=anchor.getAttribute('href');
      ev.dataTransfer.effectAllowed='copy';
      ev.dataTransfer.setData('text/uri-list',url);
      ev.dataTransfer.setData('text/plain',url);
    });
  });

  function fallbackCopy(text){
    const ta=document.createElement('textarea');
    ta.value=text;
    ta.setAttribute('readonly','');
    ta.style.position='absolute';
    ta.style.left='-9999px';
    document.body.appendChild(ta);
    ta.select();
    let ok=false;
    try{ok=document.execCommand('copy');}catch(e){}
    document.body.removeChild(ta);
    return ok;
  }

  function announceLive(message){
    if(!liveRegion) return;
    liveRegion.textContent='';
    if(liveMessageTimer){clearTimeout(liveMessageTimer);}
    if(liveResetTimer){clearTimeout(liveResetTimer);}
    liveMessageTimer=setTimeout(()=>{
      liveRegion.textContent=message;
      liveMessageTimer=null;
    },50);
    liveResetTimer=setTimeout(()=>{
      liveRegion.textContent='';
      liveResetTimer=null;
    },PULSE_TIMEOUT);
  }

  function pulse(el,label){
    if(!el.hasAttribute('data-tip-default')){
      el.setAttribute('data-tip-default',el.getAttribute('data-tip')||'');
    }
    el.setAttribute('data-tip',label);
    if(tipTimers.has(el)){
      clearTimeout(tipTimers.get(el));
    }
    announceLive(label);
    const timeout=setTimeout(()=>{
      el.setAttribute('data-tip',el.getAttribute('data-tip-default')||'');
      tipTimers.delete(el);
    },PULSE_TIMEOUT);
    tipTimers.set(el,timeout);
  }

  document.querySelectorAll('button.copy').forEach(btn=>{
    btn.addEventListener('click',async()=>{
      const url=decodeURIComponent(btn.getAttribute('data-code'));
      try{
        await navigator.clipboard.writeText(url);
        pulse(btn,'Copied!');
      }catch(err){
        fallbackCopy(url)?pulse(btn,'Copied!'):pulse(btn,'Copy failed');
      }
    });
  });
})();</script>
</body>
</html>