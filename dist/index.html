<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600;700&display=swap" rel="stylesheet">
  <script>(function(){
    try{
      var stored=localStorage.getItem('theme');
      if(stored==='dark'||stored==='light'){
        document.documentElement.setAttribute('data-theme',stored);
      }else if(window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches){
        document.documentElement.setAttribute('data-theme','dark');
      }
    }catch(e){}
  })();</script>
  <title>BSP Auto â€“ Bookmarklets</title>
  <style>:root {
  color-scheme: light;
  --maxw: 1000px;
  --bg: #ffffff;
  --fg: #0f172a;
  --muted: #64748b;
  --accent: #2563eb;
  --accent-gradient: linear-gradient(135deg, #2563eb 0%, #4f46e5 100%);
  --accent-fg: #ffffff;
  --card: rgba(248, 250, 252, 0.65);
  --border: rgba(148, 163, 184, 0.35);
  --shadow: 0 14px 32px rgba(37, 99, 235, 0.18);
  --shadow-hover: 0 18px 50px rgba(59, 130, 246, 0.28);
  --shadow-hover-button: 0 12px 32px rgba(59, 130, 246, 0.28);
  --radius: 18px;
  --tooltip-bg: rgba(15, 23, 42, 0.92);
  --tooltip-fg: #f8fafc;
}

:root[data-theme="dark"],
body[data-theme="dark"] {
  color-scheme: dark;
  --bg: #0b1220;
  --fg: #e2e8f0;
  --muted: #94a3b8;
  --accent: #3b82f6;
  --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
  --accent-fg: #0b1220;
  --card: rgba(15, 23, 42, 0.55);
  --border: rgba(96, 165, 250, 0.32);
  --shadow: 0 14px 32px rgba(37, 99, 235, 0.32);
  --shadow-hover: 0 22px 60px rgba(125, 211, 252, 0.42);
  --shadow-hover-button: 0 12px 32px rgba(125, 211, 252, 0.42);
  --tooltip-bg: rgba(226, 232, 240, 0.92);
  --tooltip-fg: #0f172a;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: 'Lexend', 'Inter', 'Inter Tight', system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Helvetica, Arial;
  background: var(--bg);
  color: var(--fg);
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 100vh;
  padding: 24px 0 32px;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: 'Lexend', 'Inter', 'Inter Tight', system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Helvetica, Arial;
}

.page {
  width: 100%;
  max-width: var(--maxw);
  margin: 0 auto;
  padding: 0 8px;
  display: flex;
  flex-direction: column;
  min-height: 100%;
  flex: 1 0 auto;
}

.topbar {
  display: flex;
  justify-content: flex-start;
  padding: 0 30px;
  margin-bottom: 12px;
}


.theme-toggle {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: var(--card);
  color: var(--fg);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  line-height: 1;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.visually-hidden {
  position: absolute !important;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.theme-toggle:hover {
  box-shadow: var(--shadow-hover);
  transform: translateY(-1px);
}

.theme-toggle:focus-visible {
  box-shadow: var(--shadow-hover);
  transform: translateY(-1px);
  outline: 2px solid var(--accent);
  outline-offset: 3px;
}

main {
  background: transparent;
  flex: 1 0 auto;
}

h1 {
  text-align: center;
  margin: 0 0 6px;
  font-weight: 700;
  letter-spacing: 0.02em;
  background-image: var(--accent-gradient);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

p.subtitle {
  text-align: center;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.24em;
  font-weight: 600;
  font-size: 13px;
  margin: 0;
}

.content-layout {
  position: relative;
  margin: 80px auto 0;
  width: min(100%, 640px);
}

section.grid {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: min(100%, 640px);
  margin: 0 auto;
}

.tutorial-card {
  width: 280px;
  position: absolute;
  top: 0;
  left: calc(100% + 28px);
}

.tutorial-card h2 {
  margin: 0;
  font-size: 18px;
  font-weight: 650;
}

.tutorial-card ol {
  margin: 12px 0 0;
  padding-left: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  color: var(--muted);
  font-size: 14px;
  line-height: 1.5;
}

.tutorial-card li strong {
  color: var(--fg);
}

@media (max-width: 1100px) {
  .content-layout {
    margin-top: 56px;
    width: min(100%, 640px);
  }

  section.grid {
    margin: 0 auto;
  }

  .tutorial-card {
    position: static;
    width: min(100%, 360px);
    margin: 32px auto 0;
  }
}

.site-footer {
  margin: 0;
  padding: 18px 0 12px;
  text-align: center;
  font-size: 0.92rem;
  color: var(--muted);
  letter-spacing: 0.04em;
  border-top: 1px solid var(--border);
}

.site-footer strong {
  font-weight: 600;
  color: var(--fg);
}

.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px 20px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  box-shadow: var(--shadow);
  backdrop-filter: saturate(150%) blur(18px);
  -webkit-backdrop-filter: saturate(150%) blur(18px);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-hover);
}

div.row1 {
  display: flex;
  align-items: center;
  gap: 12px;
  justify-content: space-between;
  flex-wrap: wrap;
}

div.row1-left {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
  min-width: 240px;
}

div.title-group {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 0;
}

a.btn {
  background-image: var(--accent-gradient);
  color: var(--accent-fg);
  text-decoration: none;
  padding: 8px 12px;
  border-radius: 16px;
  font-weight: 650;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  row-gap: 2px;
  background-size: 200% 200%;
  background-position: 0% 50%;
  transition: transform 0.2s ease, box-shadow 0.2s ease, background-position 0.3s ease;
}

span.drag-hint {
  font-size: 11px;
  font-variant: all-small-caps;
  letter-spacing: 0.16em;
  color: var(--muted);
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

span.drag-divider {
  align-self: stretch;
  border-left: 1px solid var(--border);
  width: 0;
}

a.btn:hover,
a.btn:focus-visible {
  box-shadow: var(--shadow-hover-button);
  transform: translateY(-1px);
  outline: none;
  background-position: 100% 50%;
}

span.name {
  font-weight: 600;
}

.bookmark-line {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  align-self: flex-start;
}

span.bookmark-name {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 650;
  letter-spacing: 0.02em;
  color: var(--accent);
  background: rgba(37, 99, 235, 0.12);
  padding: 2px 12px 3px;
  border-radius: 999px;
  max-width: 100%;
  word-break: break-word;
}

span.bookmark-name.is-fallback {
  color: var(--muted);
  background: rgba(100, 116, 139, 0.12);
  font-weight: 550;
}

.bookmark-line .fallback-note {
  font-size: 11px;
  color: var(--muted);
}

button.copy-name {
  border: none;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  padding: 3px;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
}

button.copy-name:hover {
  background: rgba(148, 163, 184, 0.16);
  color: var(--accent);
  transform: translateY(-1px);
}

button.copy-name:focus-visible {
  background: rgba(148, 163, 184, 0.16);
  outline: 2px solid var(--accent);
  outline-offset: 2px;
  transform: translateY(-1px);
}

html[data-theme="dark"] button.copy-name:hover,
html[data-theme="dark"] button.copy-name:focus-visible {
  background: rgba(59, 130, 246, 0.24);
}

button.copy-name svg {
  width: 18px;
  height: 18px;
}

html[data-theme="dark"] span.bookmark-name {
  color: #bfdbfe;
  background: rgba(59, 130, 246, 0.22);
}

html[data-theme="dark"] span.bookmark-name.is-fallback {
  color: var(--muted);
  background: rgba(148, 163, 184, 0.22);
}

span.badge {
  font-size: 13px;
  color: var(--muted);
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 4px 10px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: transparent;
}

details {
  border-top: 1px dashed var(--border);
  margin-top: 6px;
  padding-top: 6px;
}

summary {
  cursor: pointer;
  color: var(--muted);
  font-size: 13px;
}

div.more {
  font-size: 13px;
  color: var(--muted);
  margin-top: 4px;
}

[data-tip] {
  position: relative;
}

[data-tip]:hover::after,
[data-tip]:focus-visible::after {
  content: attr(data-tip);
  position: absolute;
  left: 50%;
  transform: translate(-50%, -8px);
  bottom: 100%;
  background: var(--tooltip-bg);
  color: var(--tooltip-fg);
  padding: 6px 10px;
  border-radius: 10px;
  font-size: 12px;
  white-space: nowrap;
  box-shadow: var(--shadow);
  pointer-events: none;
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    transition-duration: 0s !important;
    animation-duration: 0s !important;
  }
}
</style>
</head>
<body>
  <header class="topbar">
    <button id="themeToggle" class="theme-toggle" type="button" data-tip="Toggle theme" aria-label="Toggle theme">ðŸŒ—</button>
  </header>
  <div class="page">
    <main>
      <h1>BSP Auto â€“ Tools</h1>
      <p class="subtitle">- drag buttons to your bookmarks bar -</p>
      <div class="content-layout">
        <section class="grid">
          <article class="card" data-id="Copy Bookmarklet" data-bookmark="Copy - BSP Resa" data-bookmark-fallback="false">
      <div class="row1">
        <div class="row1-left">
          <a class="btn" draggable="true" href="javascript:(function()%7B%0A%20%20const%20toStringSafe%20=%20(value)%20=%3E%20(value%20==%20null%20?%20%22%22%20:%20String(value));%0A%0A%20%20const%20normalizeWhitespace%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20text%20=%20toStringSafe(value).replace(/%5B%5Cu00a0%5Cu2000-%5Cu200a%5Cu202f%5Cu205f%5Cu3000%5D/g,%20%22%20%22);%0A%20%20%20%20return%20text.replace(/%5Cs+/g,%20%22%20%22).trim();%0A%20%20%7D;%0A%0A%20%20const%20fixAccents%20=%20(value)%20=%3E%0A%20%20%20%20toStringSafe(value)%0A%20%20%20%20%20%20.replace(/d%EF%BF%BDcembre/gi,%20%22d%C3%A9cembre%22)%0A%20%20%20%20%20%20.replace(/f%EF%BF%BDvrier/gi,%20%22f%C3%A9vrier%22)%0A%20%20%20%20%20%20.replace(/ao%EF%BF%BDt/gi,%20%22ao%C3%BBt%22);%0A%0A%20%20const%20monthLookup%20=%20%7B%0A%20%20%20%20janvier:%20%2201%22,%0A%20%20%20%20fevrier:%20%2202%22,%0A%20%20%20%20mars:%20%2203%22,%0A%20%20%20%20avril:%20%2204%22,%0A%20%20%20%20mai:%20%2205%22,%0A%20%20%20%20juin:%20%2206%22,%0A%20%20%20%20juillet:%20%2207%22,%0A%20%20%20%20aout:%20%2208%22,%0A%20%20%20%20septembre:%20%2209%22,%0A%20%20%20%20octobre:%20%2210%22,%0A%20%20%20%20novembre:%20%2211%22,%0A%20%20%20%20decembre:%20%2212%22,%0A%20%20%7D;%0A%0A%20%20const%20removeWeekday%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20weekdays%20=%20%5B%0A%20%20%20%20%20%20%22lundi%22,%0A%20%20%20%20%20%20%22mardi%22,%0A%20%20%20%20%20%20%22mercredi%22,%0A%20%20%20%20%20%20%22jeudi%22,%0A%20%20%20%20%20%20%22vendredi%22,%0A%20%20%20%20%20%20%22samedi%22,%0A%20%20%20%20%20%20%22dimanche%22,%0A%20%20%20%20%5D;%0A%20%20%20%20const%20pattern%20=%20new%20RegExp(%0A%20%20%20%20%20%20%60%5E(?:$%7Bweekdays.join(%22%7C%22)%7D)(?:%5B%5C%5Cs%5C%5Cu00a0%5C%5Cu202f%5C%5Cu2009%5C%5C.,%5D)+%60,%0A%20%20%20%20%20%20%22i%22%0A%20%20%20%20);%0A%20%20%20%20return%20toStringSafe(value).replace(pattern,%20%22%22);%0A%20%20%7D;%0A%0A%20%20const%20normalizeMonthKey%20=%20(value)%20=%3E%0A%20%20%20%20toStringSafe(value)%0A%20%20%20%20%20%20.toLowerCase()%0A%20%20%20%20%20%20.normalize(%22NFD%22)%0A%20%20%20%20%20%20.replace(/%5B%5Cu0300-%5Cu036f%5D/g,%20%22%22)%0A%20%20%20%20%20%20.replace(/%5B%5Ea-z%5D/g,%20%22%22);%0A%0A%20%20const%20getIata%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20matches%20=%20normalizeWhitespace(value).match(/%5Cb%5BA-Z%5D%7B3%7D%5Cb/g);%0A%20%20%20%20return%20matches%20?%20matches%5Bmatches.length%20-%201%5D%20:%20null;%0A%20%20%7D;%0A%0A%20%20const%20getStationCode%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20match%20=%20toStringSafe(value).match(/-%5Cs*(%5Cd%7B4,5%7D)%5Cs*$/);%0A%20%20%20%20return%20match%20?%20match%5B1%5D%20:%20null;%0A%20%20%7D;%0A%0A%20%20const%20getTime%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20text%20=%20toStringSafe(value);%0A%20%20%20%20const%20regex%20=%20/(?:%5E%7C%5B%5E0-9%5D)(%5Cd%7B1,2%7D)%5Cs*%5B:h%5D%5Cs*(%5Cd%7B2%7D)(?!%5Cd)/gi;%0A%20%20%20%20let%20match;%0A%20%20%20%20let%20lastMatch%20=%20null;%0A%20%20%20%20while%20((match%20=%20regex.exec(text))%20!==%20null)%20%7B%0A%20%20%20%20%20%20lastMatch%20=%20match;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!lastMatch)%20return%20null;%0A%20%20%20%20const%20hours%20=%20String(parseInt(lastMatch%5B1%5D,%2010)).padStart(2,%20%220%22);%0A%20%20%20%20const%20minutes%20=%20String(parseInt(lastMatch%5B2%5D,%2010)).padStart(2,%20%220%22);%0A%20%20%20%20return%20%60$%7Bhours%7D:$%7Bminutes%7D%60;%0A%20%20%7D;%0A%0A%20%20const%20getDate%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20cleaned%20=%20normalizeWhitespace(removeWeekday(fixAccents(value)));%0A%20%20%20%20const%20match%20=%20cleaned.match(/(%5Cd%7B1,2%7D)%5Cs+(%5Ba-z%C3%A0%C3%A2%C3%A7%C3%A9%C3%A8%C3%AA%C3%AB%C3%AE%C3%AF%C3%B4%C3%BB%C3%B9%C3%BC%C3%BF%C3%B1%C3%A6%C5%93%5D+)%5Cs+(%5Cd%7B4%7D)/i);%0A%20%20%20%20if%20(!match)%20return%20null;%0A%20%20%20%20const%20day%20=%20String(parseInt(match%5B1%5D,%2010)).padStart(2,%20%220%22);%0A%20%20%20%20const%20monthKey%20=%20normalizeMonthKey(match%5B2%5D);%0A%20%20%20%20const%20month%20=%20monthLookup%5BmonthKey%5D;%0A%20%20%20%20if%20(!month)%20return%20null;%0A%20%20%20%20return%20%60$%7Bmatch%5B3%5D%7D-$%7Bmonth%7D-$%7Bday%7D%60;%0A%20%20%7D;%0A%0A%20%20const%20getSectionData%20=%20(selector,%20keyword)%20=%3E%20%7B%0A%20%20%20%20const%20container%20=%20document.querySelector(%22%23infos%22);%0A%20%20%20%20if%20(!container)%20return%20null;%0A%0A%20%20%20%20const%20title%20=%20Array.from(container.querySelectorAll(selector)).find((node)%20=%3E%0A%20%20%20%20%20%20normalizeWhitespace(node.textContent%20%7C%7C%20%22%22).toLowerCase().includes(keyword)%0A%20%20%20%20);%0A%0A%20%20%20%20if%20(!title)%20return%20null;%0A%0A%20%20%20%20const%20findNextTxt%20=%20(node)%20=%3E%20%7B%0A%20%20%20%20%20%20let%20current%20=%20node.nextElementSibling;%0A%20%20%20%20%20%20while%20(current)%20%7B%0A%20%20%20%20%20%20%20%20if%20(current.classList%20&&%20current.classList.contains(%22txt%22))%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20current;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20current%20=%20current.nextElementSibling;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null;%0A%20%20%20%20%7D;%0A%0A%20%20%20%20const%20stationElement%20=%20findNextTxt(title);%0A%20%20%20%20const%20dateElement%20=%20stationElement%20?%20findNextTxt(stationElement)%20:%20null;%0A%0A%20%20%20%20const%20stationLine%20=%20stationElement%20?%20stationElement.textContent%20:%20%22%22;%0A%20%20%20%20const%20boldNode%20=%20stationElement%20?%20stationElement.querySelector(%22b%22)%20:%20null;%0A%20%20%20%20const%20stationRaw%20=%20normalizeWhitespace(boldNode%20?%20boldNode.textContent%20:%20%22%22);%0A%20%20%20%20const%20stationCode%20=%20stationElement%20?%20getStationCode(normalizeWhitespace(stationLine))%20:%20null;%0A%20%20%20%20const%20iata%20=%20stationRaw%20?%20getIata(stationRaw)%20:%20null;%0A%0A%20%20%20%20const%20dateRaw%20=%20normalizeWhitespace(dateElement%20?%20dateElement.textContent%20:%20%22%22);%0A%20%20%20%20const%20time%20=%20dateRaw%20?%20getTime(dateRaw)%20:%20null;%0A%20%20%20%20const%20date%20=%20dateRaw%20?%20getDate(dateRaw)%20:%20null;%0A%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20station:%20%7B%0A%20%20%20%20%20%20%20%20raw:%20stationRaw%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20stationCode:%20stationCode%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20iata,%0A%20%20%20%20%20%20%7D,%0A%20%20%20%20%20%20datetime:%20%7B%0A%20%20%20%20%20%20%20%20dateRaw:%20dateRaw%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20date:%20date%20%7C%7C%20null,%0A%20%20%20%20%20%20%20%20time,%0A%20%20%20%20%20%20%7D,%0A%20%20%20%20%7D;%0A%20%20%7D;%0A%0A%20%20const%20pickupData%20=%20getSectionData(%22.tit%22,%20%22prise%22);%0A%20%20const%20returnData%20=%20getSectionData(%22.tit.top1%22,%20%22retour%22);%0A%0A%20%20const%20getInputValue%20=%20(selector)%20=%3E%20%7B%0A%20%20%20%20const%20element%20=%20document.querySelector(selector);%0A%20%20%20%20if%20(!element)%20return%20null;%0A%20%20%20%20if%20(%22value%22%20in%20element)%20%7B%0A%20%20%20%20%20%20return%20element.value%20??%20null;%0A%20%20%20%20%7D%0A%20%20%20%20return%20element.textContent%20??%20null;%0A%20%20%7D;%0A%0A%20%20const%20getDriverData%20=%20()%20=%3E%20%7B%0A%20%20%20%20const%20firstName%20=%20getInputValue('input%5Bname=%22prenom%22%5D');%0A%20%20%20%20const%20lastName%20=%20getInputValue('input%5Bname=%22nom%22%5D');%0A%20%20%20%20const%20phone%20=%20getInputValue('input%5Bname=%22num_tel%22%5D');%0A%20%20%20%20const%20email%20=%20getInputValue('input%5Bname=%22email%22%5D');%0A%0A%20%20%20%20const%20flightContainer%20=%20document.querySelector(%22%23infos%22);%0A%20%20%20%20let%20flightNumber%20=%20null;%0A%20%20%20%20if%20(flightContainer)%20%7B%0A%20%20%20%20%20%20const%20flightNode%20=%20Array.from(%0A%20%20%20%20%20%20%20%20flightContainer.querySelectorAll(%22.tit,%20.tit.top1%22)%0A%20%20%20%20%20%20).find((node)%20=%3E%0A%20%20%20%20%20%20%20%20normalizeWhitespace(node.textContent%20%7C%7C%20%22%22)%0A%20%20%20%20%20%20%20%20%20%20.toLowerCase()%0A%20%20%20%20%20%20%20%20%20%20.includes(%22vol/train%22)%0A%20%20%20%20%20%20);%0A%20%20%20%20%20%20if%20(flightNode)%20%7B%0A%20%20%20%20%20%20%20%20const%20match%20=%20toStringSafe(flightNode.textContent).match(/Vol%5C/Train%5Cs*:%5Cs*(%5BA-Z%5D%7B1,3%7D%5Cs?%5Cd%7B1,4%7D%5BA-Z%5D?)/i);%0A%20%20%20%20%20%20%20%20flightNumber%20=%20match%20?%20match%5B1%5D%20:%20%22%22;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20firstName:%20firstName%20??%20null,%0A%20%20%20%20%20%20lastName:%20lastName%20??%20null,%0A%20%20%20%20%20%20phone:%20phone%20??%20null,%0A%20%20%20%20%20%20email:%20email%20??%20null,%0A%20%20%20%20%20%20flightNumber:%20flightNumber%20??%20null,%0A%20%20%20%20%7D;%0A%20%20%7D;%0A%0A%20%20const%20result%20=%20%7B%0A%20%20%20%20pickupStation:%20pickupData%0A%20%20%20%20%20%20?%20pickupData.station%0A%20%20%20%20%20%20:%20%7B%20raw:%20null,%20stationCode:%20null,%20iata:%20null%20%7D,%0A%20%20%20%20pickup:%20pickupData%0A%20%20%20%20%20%20?%20pickupData.datetime%0A%20%20%20%20%20%20:%20%7B%20dateRaw:%20null,%20date:%20null,%20time:%20null%20%7D,%0A%20%20%20%20returnStation:%20returnData%0A%20%20%20%20%20%20?%20returnData.station%0A%20%20%20%20%20%20:%20%7B%20raw:%20null,%20stationCode:%20null,%20iata:%20null%20%7D,%0A%20%20%20%20return:%20returnData%0A%20%20%20%20%20%20?%20returnData.datetime%0A%20%20%20%20%20%20:%20%7B%20dateRaw:%20null,%20date:%20null,%20time:%20null%20%7D,%0A%20%20%20%20driver:%20getDriverData(),%0A%20%20%7D;%0A%0A%20%20const%20logStructuredResult%20=%20(data)%20=%3E%20%7B%0A%20%20%20%20if%20(!data%20%7C%7C%20typeof%20data%20!==%20%22object%22)%20%7B%0A%20%20%20%20%20%20console.warn(%22bspAutoBookingData%20is%20empty%20or%20invalid%22,%20data);%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%0A%20%20%20%20console.group(%22bspAutoBookingData%20(structured)%22);%0A%20%20%20%20%5B%0A%20%20%20%20%20%20%7B%20title:%20%22Pickup%20Station%22,%20value:%20data.pickupStation%20%7D,%0A%20%20%20%20%20%20%7B%20title:%20%22Pickup%20Date/Time%22,%20value:%20data.pickup%20%7D,%0A%20%20%20%20%20%20%7B%20title:%20%22Return%20Station%22,%20value:%20data.returnStation%20%7D,%0A%20%20%20%20%20%20%7B%20title:%20%22Return%20Date/Time%22,%20value:%20data.return%20%7D,%0A%20%20%20%20%20%20%7B%20title:%20%22Driver%22,%20value:%20data.driver%20%7D,%0A%20%20%20%20%5D.forEach((%7B%20title,%20value%20%7D)%20=%3E%20%7B%0A%20%20%20%20%20%20console.group(title);%0A%20%20%20%20%20%20if%20(value%20&&%20typeof%20value%20===%20%22object%22)%20%7B%0A%20%20%20%20%20%20%20%20console.table(%5Bvalue%5D);%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.log(value);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20console.groupEnd();%0A%20%20%20%20%7D);%0A%20%20%20%20console.groupEnd();%0A%20%20%7D;%0A%0A%20%20const%20hasNonNullValue%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20if%20(Array.isArray(value))%20%7B%0A%20%20%20%20%20%20return%20value.some(hasNonNullValue);%0A%20%20%20%20%7D%0A%20%20%20%20if%20(value%20&&%20typeof%20value%20===%20%22object%22)%20%7B%0A%20%20%20%20%20%20return%20Object.values(value).some(hasNonNullValue);%0A%20%20%20%20%7D%0A%20%20%20%20return%20value%20!=%20null;%0A%20%20%7D;%0A%0A%20%20const%20showToast%20=%20(message,%20%7B%20error%20=%20false%20%7D%20=%20%7B%7D)%20=%3E%20%7B%0A%20%20%20%20const%20existing%20=%20document.querySelector(%22%23bsp-auto-toast%22);%0A%20%20%20%20if%20(existing)%20%7B%0A%20%20%20%20%20%20existing.remove();%0A%20%20%20%20%7D%0A%20%20%20%20const%20toast%20=%20document.createElement(%22div%22);%0A%20%20%20%20toast.id%20=%20%22bsp-auto-toast%22;%0A%20%20%20%20toast.style.position%20=%20%22fixed%22;%0A%20%20%20%20toast.style.top%20=%20%2216px%22;%0A%20%20%20%20toast.style.left%20=%20%2250%25%22;%0A%20%20%20%20toast.style.transform%20=%20%22translateX(-50%25)%22;%0A%20%20%20%20toast.style.padding%20=%20%2210px%2016px%22;%0A%20%20%20%20toast.style.background%20=%20error%20?%20%22%23e67e22%22%20:%20%22%232ecc71%22;%0A%20%20%20%20toast.style.color%20=%20%22%23fff%22;%0A%20%20%20%20toast.style.font%20=%20%2214px/1.4%20sans-serif%22;%0A%20%20%20%20toast.style.borderRadius%20=%20%224px%22;%0A%20%20%20%20toast.style.boxShadow%20=%20%220%204px%2012px%20rgba(0,%200,%200,%200.15)%22;%0A%20%20%20%20toast.style.zIndex%20=%20%222147483647%22;%0A%20%20%20%20toast.style.display%20=%20%22flex%22;%0A%20%20%20%20toast.style.alignItems%20=%20%22center%22;%0A%20%20%20%20toast.style.gap%20=%20%2212px%22;%0A%0A%20%20%20%20const%20label%20=%20document.createElement(%22span%22);%0A%20%20%20%20label.textContent%20=%20message;%0A%20%20%20%20toast.appendChild(label);%0A%0A%20%20%20%20document.body.appendChild(toast);%0A%20%20%20%20setTimeout(()%20=%3E%20%7B%0A%20%20%20%20%20%20toast.style.transition%20=%20%22opacity%20200ms%20ease%22;%0A%20%20%20%20%20%20toast.style.opacity%20=%20%220%22;%0A%20%20%20%20%20%20setTimeout(()%20=%3E%20toast.remove(),%20220);%0A%20%20%20%20%7D,%204000);%0A%20%20%7D;%0A%0A%20%20if%20(!hasNonNullValue(result))%20%7B%0A%20%20%20%20console.warn(%22No%20BSP%20data%20found%22,%20result);%0A%20%20%20%20showToast(%22No%20data%20found%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20return;%0A%20%20%7D%0A%0A%20%20try%20%7B%0A%20%20%20%20localStorage.setItem(%22bspAutoBookingData%22,%20JSON.stringify(result));%0A%20%20%20%20console.info(%22bspAutoBookingData%20updated%22,%20result);%0A%20%20%20%20logStructuredResult(result);%0A%20%20%20%20showToast(%22BSP%20data%20copied%22);%0A%20%20%20%20const%20openPasteBookmarkletPage%20=%20()%20=%3E%0A%20%20%20%20%20%20window.open(%0A%20%20%20%20%20%20%20%20%22https://www.bsp-auto.com/auto_2175bsp/tarifs.asp%22,%0A%20%20%20%20%20%20%20%20%22_blank%22,%0A%20%20%20%20%20%20%20%20%22noopener%22%0A%20%20%20%20%20%20);%0A%20%20%20%20setTimeout(openPasteBookmarkletPage,%201000);%0A%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20console.error(%22Failed%20to%20store%20bspAutoBookingData%22,%20error,%20result);%0A%20%20%20%20showToast(%22Failed%20to%20copy%20BSP%20data%22,%20%7B%20error:%20true%20%7D);%0A%20%20%7D%0A%7D)();" data-tip="Drag to bookmarks" aria-label="Drag Copy - BSP Resa bookmarklet to your bar">ðŸ”— Code</a>
          <span class="drag-hint">â‡¢ Drag me</span>
          <span class="drag-divider" aria-hidden="true"></span>
          <div class="title-group">
            <span class="name">Copy Bookmarklet</span>
            <div class="bookmark-line"><span class="bookmark-name">Copy - BSP Resa</span><button class="copy-name" type="button" data-name="Copy - BSP Resa" data-tip="Copy name" aria-label="Copy bookmark name"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><rect x="8" y="3.5" width="11.5" height="14.5" rx="2.5" ry="2.5" fill="currentColor"/><rect x="4.5" y="6.5" width="11.5" height="14.5" rx="2.5" ry="2.5" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/></svg></button></div>
          </div>
        </div>
        <span class="badge">GENERAL</span>
      </div>
      <details><summary>More info</summary><div class="more">Copies the following Reservation Data: Pick Up/ Drop Off-Station, Date and Time. Then opens the simulation BSP simulation Page in a new tab.</div></details>
    </article>
<article class="card" data-id="Fill Bookmarklet" data-bookmark="Fill - BSP Tarifs" data-bookmark-fallback="false">
      <div class="row1">
        <div class="row1-left">
          <a class="btn" draggable="true" href="javascript:(async%20function()%7B%0A%20%20const%20STORAGE_KEY%20=%20%22bspAutoBookingData%22;%0A%20%20const%20AUTOCOMPLETE_SELECTOR%20=%20%22.ui-autocomplete.ui-front%22;%0A%20%20const%20AUTOCOMPLETE_ITEM_SELECTOR%20=%0A%20%20%20%20%22li.ui-menu-item%20%3E%20.ui-menu-item-wrapper,%20.ui-menu-item-wrapper%22;%0A%0A%20%20const%20wait%20=%20(ms)%20=%3E%20new%20Promise((resolve)%20=%3E%20setTimeout(resolve,%20ms));%0A%0A%20%20const%20waitFor%20=%20async%20(predicate,%20%7B%20timeout%20=%204000,%20interval%20=%20100%20%7D%20=%20%7B%7D)%20=%3E%20%7B%0A%20%20%20%20const%20start%20=%20Date.now();%0A%20%20%20%20while%20(Date.now()%20-%20start%20%3C%20timeout)%20%7B%0A%20%20%20%20%20%20const%20result%20=%20await%20predicate();%0A%20%20%20%20%20%20if%20(result)%20return%20result;%0A%20%20%20%20%20%20await%20wait(interval);%0A%20%20%20%20%7D%0A%20%20%20%20return%20null;%0A%20%20%7D;%0A%0A%20%20const%20toStringSafe%20=%20(value)%20=%3E%20(value%20==%20null%20?%20%22%22%20:%20String(value));%0A%0A%20%20const%20normalizeText%20=%20(value)%20=%3E%20toStringSafe(value).trim();%0A%0A%20%20const%20normalizeForMatch%20=%20(value)%20=%3E%0A%20%20%20%20toStringSafe(value)%0A%20%20%20%20%20%20.normalize(%22NFD%22)%0A%20%20%20%20%20%20.replace(/%5B%5Cu0300-%5Cu036f%5D/g,%20%22%22)%0A%20%20%20%20%20%20.toLowerCase()%0A%20%20%20%20%20%20.replace(/%5Cs+/g,%20%22%20%22)%0A%20%20%20%20%20%20.trim();%0A%0A%20%20const%20isVisible%20=%20(element)%20=%3E%20%7B%0A%20%20%20%20if%20(!element)%20return%20false;%0A%20%20%20%20const%20style%20=%20window.getComputedStyle(element);%0A%20%20%20%20if%20(style.display%20===%20%22none%22%20%7C%7C%20style.visibility%20===%20%22hidden%22%20%7C%7C%20style.opacity%20===%20%220%22)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%20%20const%20rect%20=%20element.getBoundingClientRect();%0A%20%20%20%20return%20rect.width%20%3E%200%20&&%20rect.height%20%3E%200;%0A%20%20%7D;%0A%0A%20%20const%20typeText%20=%20async%20(element,%20text)%20=%3E%20%7B%0A%20%20%20%20const%20value%20=%20toStringSafe(text);%0A%20%20%20%20element.value%20=%20%22%22;%0A%20%20%20%20element.dispatchEvent(new%20Event(%22input%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20element.value%20=%20value;%0A%20%20%20%20element.dispatchEvent(new%20Event(%22input%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20element.dispatchEvent(new%20Event(%22change%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%7D;%0A%0A%20%20const%20collectOptions%20=%20(itemElements)%20=%3E%0A%20%20%20%20itemElements.map((el)%20=%3E%20(%7B%0A%20%20%20%20%20%20el,%0A%20%20%20%20%20%20label:%20normalizeText(el.getAttribute(%22data-label%22)%20%7C%7C%20el.textContent),%0A%20%20%20%20%7D));%0A%0A%20%20const%20showToast%20=%20(message,%20%7B%20error%20=%20false%20%7D%20=%20%7B%7D)%20=%3E%20%7B%0A%20%20%20%20const%20existing%20=%20document.querySelector(%22%23bsp-auto-toast%22);%0A%20%20%20%20if%20(existing)%20%7B%0A%20%20%20%20%20%20existing.remove();%0A%20%20%20%20%7D%0A%20%20%20%20const%20toast%20=%20document.createElement(%22div%22);%0A%20%20%20%20toast.id%20=%20%22bsp-auto-toast%22;%0A%20%20%20%20toast.style.position%20=%20%22fixed%22;%0A%20%20%20%20toast.style.top%20=%20%2216px%22;%0A%20%20%20%20toast.style.left%20=%20%2250%25%22;%0A%20%20%20%20toast.style.transform%20=%20%22translateX(-50%25)%22;%0A%20%20%20%20toast.style.padding%20=%20%2210px%2016px%22;%0A%20%20%20%20toast.style.background%20=%20error%20?%20%22%23e67e22%22%20:%20%22%232ecc71%22;%0A%20%20%20%20toast.style.color%20=%20%22%23fff%22;%0A%20%20%20%20toast.style.font%20=%20%2214px/1.4%20sans-serif%22;%0A%20%20%20%20toast.style.borderRadius%20=%20%224px%22;%0A%20%20%20%20toast.style.boxShadow%20=%20%220%204px%2012px%20rgba(0,%200,%200,%200.15)%22;%0A%20%20%20%20toast.style.zIndex%20=%20%222147483647%22;%0A%20%20%20%20toast.style.display%20=%20%22flex%22;%0A%20%20%20%20toast.style.alignItems%20=%20%22center%22;%0A%20%20%20%20toast.style.gap%20=%20%2212px%22;%0A%0A%20%20%20%20const%20label%20=%20document.createElement(%22span%22);%0A%20%20%20%20label.textContent%20=%20message;%0A%20%20%20%20toast.appendChild(label);%0A%0A%20%20%20%20document.body.appendChild(toast);%0A%20%20%20%20setTimeout(()%20=%3E%20%7B%0A%20%20%20%20%20%20toast.style.transition%20=%20%22opacity%20200ms%20ease%22;%0A%20%20%20%20%20%20toast.style.opacity%20=%20%220%22;%0A%20%20%20%20%20%20setTimeout(()%20=%3E%20toast.remove(),%20220);%0A%20%20%20%20%7D,%204000);%0A%20%20%7D;%0A%0A%20%20const%20sanitizeDriver%20=%20(driver)%20=%3E%20%7B%0A%20%20%20%20if%20(!driver%20%7C%7C%20typeof%20driver%20!==%20%22object%22)%20return%20null;%0A%20%20%20%20const%20toNullableString%20=%20(value)%20=%3E%20(value%20==%20null%20?%20null%20:%20String(value));%0A%20%20%20%20const%20sanitized%20=%20%7B%0A%20%20%20%20%20%20firstName:%20toNullableString(driver.firstName),%0A%20%20%20%20%20%20lastName:%20toNullableString(driver.lastName),%0A%20%20%20%20%20%20phone:%20toNullableString(driver.phone),%0A%20%20%20%20%20%20email:%20toNullableString(driver.email),%0A%20%20%20%20%20%20flightNumber:%20toNullableString(driver.flightNumber),%0A%20%20%20%20%7D;%0A%20%20%20%20const%20hasContent%20=%20Object.values(sanitized).some((value)%20=%3E%20value%20!=%20null);%0A%20%20%20%20return%20hasContent%20?%20sanitized%20:%20null;%0A%20%20%7D;%0A%0A%20%20const%20parseStorage%20=%20()%20=%3E%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20const%20raw%20=%20localStorage.getItem(STORAGE_KEY);%0A%20%20%20%20%20%20if%20(!raw)%20return%20null;%0A%0A%20%20%20%20%20%20const%20parsed%20=%20JSON.parse(raw);%0A%0A%20%20%20%20%20%20const%20normalizeStation%20=%20(station)%20=%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20(!station)%20return%20null;%0A%20%20%20%20%20%20%20%20const%20rawValue%20=%20normalizeText(station.raw);%0A%20%20%20%20%20%20%20%20if%20(!rawValue)%20return%20null;%0A%0A%20%20%20%20%20%20%20%20const%20normalized%20=%20%7B%20raw:%20rawValue%20%7D;%0A%0A%20%20%20%20%20%20%20%20const%20stationCode%20=%20normalizeText(station.stationCode);%0A%20%20%20%20%20%20%20%20if%20(stationCode)%20%7B%0A%20%20%20%20%20%20%20%20%20%20normalized.stationCode%20=%20stationCode;%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20const%20iata%20=%20normalizeText(station.iata);%0A%20%20%20%20%20%20%20%20if%20(iata)%20%7B%0A%20%20%20%20%20%20%20%20%20%20normalized.iata%20=%20iata;%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20normalized;%0A%20%20%20%20%20%20%7D;%0A%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20...parsed,%0A%20%20%20%20%20%20%20%20pickupStation:%20normalizeStation(parsed.pickupStation),%0A%20%20%20%20%20%20%20%20returnStation:%20normalizeStation(parsed.returnStation),%0A%20%20%20%20%20%20%20%20driver:%20sanitizeDriver(parsed.driver),%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20%20%20return%20null;%0A%20%20%20%20%7D%0A%20%20%7D;%0A%0A%20%20const%20fillAutocomplete%20=%20async%20(%7B%20inputSelector,%20station%20%7D)%20=%3E%20%7B%0A%20%20%20%20const%20input%20=%20await%20waitFor(()%20=%3E%20document.querySelector(inputSelector));%0A%20%20%20%20if%20(!input)%20%7B%0A%20%20%20%20%20%20throw%20new%20Error(%22Feld%20nicht%20gefunden%22);%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20rawValue%20=%20toStringSafe(station?.raw);%0A%20%20%20%20if%20(!normalizeText(rawValue))%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20normalizedRaw%20=%20normalizeForMatch(rawValue);%0A%20%20%20%20const%20rawContainsAeroport%20=%20/aeroport/i.test(rawValue);%0A%20%20%20%20const%20fallbackIata%20=%20normalizeText(station?.iata);%0A%20%20%20%20const%20fallbackValue%20=%20rawContainsAeroport%20&&%20fallbackIata%0A%20%20%20%20%20%20?%20%60Aeroport%20$%7BfallbackIata%7D%60%0A%20%20%20%20%20%20:%20null;%0A%0A%20%20%20%20input.focus();%0A%20%20%20%20await%20wait(30);%0A%0A%20%20%20%20const%20findSuggestions%20=%20()%20=%3E%20%7B%0A%20%20%20%20%20%20const%20lists%20=%20Array.from(document.querySelectorAll(AUTOCOMPLETE_SELECTOR));%0A%20%20%20%20%20%20for%20(const%20list%20of%20lists)%20%7B%0A%20%20%20%20%20%20%20%20if%20(!isVisible(list))%20continue;%0A%20%20%20%20%20%20%20%20const%20found%20=%20Array.from(list.querySelectorAll(AUTOCOMPLETE_ITEM_SELECTOR));%0A%20%20%20%20%20%20%20%20if%20(found.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20found;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null;%0A%20%20%20%20%7D;%0A%0A%20%20%20%20const%20typeAndCollect%20=%20async%20(text)%20=%3E%20%7B%0A%20%20%20%20%20%20if%20(!normalizeText(text))%20return%20null;%0A%20%20%20%20%20%20input.focus();%0A%20%20%20%20%20%20await%20typeText(input,%20text);%0A%20%20%20%20%20%20await%20wait(150);%0A%20%20%20%20%20%20const%20collected%20=%20await%20waitFor(findSuggestions,%20%7B%20timeout:%201000,%20interval:%2080%20%7D);%0A%20%20%20%20%20%20return%20collected;%0A%20%20%20%20%7D;%0A%0A%20%20%20%20let%20items%20=%20await%20typeAndCollect(rawValue);%0A%0A%20%20%20%20if%20(!items%20&&%20fallbackValue)%20%7B%0A%20%20%20%20%20%20items%20=%20await%20typeAndCollect(fallbackValue);%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!items)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%20%20%20%20const%20options%20=%20collectOptions(items).map((option)%20=%3E%20(%7B%0A%20%20%20%20%20%20...option,%0A%20%20%20%20%20%20normalized:%20normalizeForMatch(option.label),%0A%20%20%20%20%7D));%0A%20%20%20%20if%20(!options.length)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20isExactMatch%20=%20(optionNormalized)%20=%3E%0A%20%20%20%20%20%20optionNormalized%20===%20normalizedRaw%20%7C%7C%20optionNormalized.includes(normalizedRaw);%0A%20%20%20%20let%20candidate%20=%20options.find((option)%20=%3E%20isExactMatch(option.normalized));%0A%20%20%20%20if%20(!candidate)%20%7B%0A%20%20%20%20%20%20candidate%20=%20options%5B0%5D;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!candidate)%20%7B%0A%20%20%20%20%20%20return%20false;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20target%20=%20candidate.el;%0A%20%20%20%20if%20(typeof%20target.scrollIntoView%20===%20%22function%22)%20%7B%0A%20%20%20%20%20%20target.scrollIntoView(%7B%20block:%20%22nearest%22%20%7D);%0A%20%20%20%20%7D%0A%0A%20%20%20%20%5B%22mouseover%22,%20%22mousedown%22,%20%22mouseup%22,%20%22click%22%5D.forEach((type)%20=%3E%20%7B%0A%20%20%20%20%20%20target.dispatchEvent(new%20MouseEvent(type,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20%7D);%0A%0A%20%20%20%20await%20wait(80);%0A%20%20%20%20return%20true;%0A%20%20%7D;%0A%0A%20%20const%20formatIsoDateToFr%20=%20(isoDate)%20=%3E%20%7B%0A%20%20%20%20const%20targetDate%20=%20new%20Date(%60$%7BisoDate%7DT00:00:00%60);%0A%20%20%20%20if%20(Number.isNaN(targetDate.getTime()))%20%7B%0A%20%20%20%20%20%20throw%20new%20Error(%22Ung%C3%BCltiges%20Datum%22);%0A%20%20%20%20%7D%0A%20%20%20%20const%20day%20=%20String(targetDate.getDate()).padStart(2,%20%220%22);%0A%20%20%20%20const%20month%20=%20String(targetDate.getMonth()%20+%201).padStart(2,%20%220%22);%0A%20%20%20%20const%20year%20=%20targetDate.getFullYear();%0A%20%20%20%20return%20%60$%7Bday%7D/$%7Bmonth%7D/$%7Byear%7D%60;%0A%20%20%7D;%0A%0A%20%20const%20setDate%20=%20async%20(selector,%20isoDate)%20=%3E%20%7B%0A%20%20%20%20if%20(!isoDate)%20return;%0A%20%20%20%20const%20input%20=%20await%20waitFor(()%20=%3E%20document.querySelector(selector));%0A%20%20%20%20if%20(!input)%20throw%20new%20Error(%22Datumfeld%20fehlt%22);%0A%20%20%20%20const%20formatted%20=%20formatIsoDateToFr(isoDate);%0A%20%20%20%20input.value%20=%20formatted;%0A%20%20%20%20input.dispatchEvent(new%20Event(%22input%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%20%20input.dispatchEvent(new%20Event(%22change%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%7D;%0A%0A%20%20const%20timeToMinutes%20=%20(value)%20=%3E%20%7B%0A%20%20%20%20const%20match%20=%20toStringSafe(value).match(/%5E(%5Cd%7B1,2%7D):(%5Cd%7B2%7D)$/);%0A%20%20%20%20if%20(!match)%20return%20null;%0A%20%20%20%20return%20parseInt(match%5B1%5D,%2010)%20*%2060%20+%20parseInt(match%5B2%5D,%2010);%0A%20%20%7D;%0A%0A%20%20const%20setTime%20=%20async%20(selector,%20timeValue)%20=%3E%20%7B%0A%20%20%20%20if%20(!timeValue)%20return;%0A%20%20%20%20const%20select%20=%20await%20waitFor(()%20=%3E%20document.querySelector(selector));%0A%20%20%20%20if%20(!select)%20throw%20new%20Error(%22Zeitfeld%20fehlt%22);%0A%20%20%20%20const%20targetMinutes%20=%20timeToMinutes(timeValue);%0A%20%20%20%20const%20options%20=%20Array.from(select.options).filter((option)%20=%3E%20option.value);%0A%20%20%20%20if%20(!options.length)%20throw%20new%20Error(%22Keine%20Zeitoptionen%22);%0A%0A%20%20%20%20const%20sorted%20=%20options%0A%20%20%20%20%20%20.map((option)%20=%3E%20(%7B%20option,%20minutes:%20timeToMinutes(option.value)%20%7D))%0A%20%20%20%20%20%20.filter((%7B%20minutes%20%7D)%20=%3E%20minutes%20!=%20null)%0A%20%20%20%20%20%20.sort((a,%20b)%20=%3E%20a.minutes%20-%20b.minutes);%0A%0A%20%20%20%20let%20chosen%20=%20sorted.find((%7B%20minutes%20%7D)%20=%3E%20minutes%20%3E=%20targetMinutes);%0A%20%20%20%20if%20(!chosen)%20%7B%0A%20%20%20%20%20%20chosen%20=%20sorted%5Bsorted.length%20-%201%5D;%0A%20%20%20%20%7D%0A%20%20%20%20if%20(!chosen)%20throw%20new%20Error(%22Zeit%20nicht%20verf%C3%BCgbar%22);%0A%0A%20%20%20%20select.value%20=%20chosen.option.value;%0A%20%20%20%20select.dispatchEvent(new%20Event(%22change%22,%20%7B%20bubbles:%20true%20%7D));%0A%20%20%7D;%0A%0A%20%20const%20fillDriverDetails%20=%20async%20(driver)%20=%3E%20%7B%0A%20%20%20%20if%20(!driver)%20%7B%0A%20%20%20%20%20%20throw%20new%20Error(%22Keine%20Fahrerinformationen%20vorhanden%22);%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20firstField%20=%20await%20waitFor(()%20=%3E%20document.querySelector('input%5Bname=%22prenom%22%5D'));%0A%20%20%20%20if%20(!firstField)%20%7B%0A%20%20%20%20%20%20throw%20new%20Error(%22Feld%20input%5Bname=%5C%22prenom%5C%22%5D%20nicht%20gefunden%22);%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20focusAndSelect%20=%20async%20(element)%20=%3E%20%7B%0A%20%20%20%20%20%20if%20(!element)%20return;%0A%20%20%20%20%20%20if%20(typeof%20element.focus%20===%20%22function%22)%20%7B%0A%20%20%20%20%20%20%20%20element.focus();%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20await%20wait(30);%0A%20%20%20%20%20%20if%20(typeof%20element.select%20===%20%22function%22)%20%7B%0A%20%20%20%20%20%20%20%20element.select();%0A%20%20%20%20%20%20%20%20await%20wait(30);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D;%0A%0A%20%20%20%20const%20isTabCandidate%20=%20(element)%20=%3E%20%7B%0A%20%20%20%20%20%20if%20(!element)%20return%20false;%0A%20%20%20%20%20%20if%20(element.disabled)%20return%20false;%0A%20%20%20%20%20%20if%20(element.tabIndex%20!=%20null%20&&%20element.tabIndex%20%3C%200)%20return%20false;%0A%20%20%20%20%20%20if%20(element.type%20===%20%22hidden%22)%20return%20false;%0A%20%20%20%20%20%20return%20isVisible(element);%0A%20%20%20%20%7D;%0A%0A%20%20%20%20const%20collectTabStops%20=%20()%20=%3E%20%7B%0A%20%20%20%20%20%20const%20base%20=%20firstField.form%0A%20%20%20%20%20%20%20%20?%20Array.from(firstField.form.elements)%0A%20%20%20%20%20%20%20%20:%20Array.from(%0A%20%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20'input,%20select,%20textarea,%20button,%20a%5Bhref%5D,%20%5Btabindex%5D:not(%5Btabindex=%22-1%22%5D)'%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20);%0A%20%20%20%20%20%20const%20filtered%20=%20base.filter((element)%20=%3E%20isTabCandidate(element));%0A%20%20%20%20%20%20if%20(!filtered.includes(firstField))%20%7B%0A%20%20%20%20%20%20%20%20return%20%5BfirstField,%20...filtered%5D;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20filtered;%0A%20%20%20%20%7D;%0A%0A%20%20%20%20const%20tabStops%20=%20collectTabStops();%0A%20%20%20%20let%20index%20=%20tabStops.indexOf(firstField);%0A%20%20%20%20if%20(index%20===%20-1)%20%7B%0A%20%20%20%20%20%20tabStops.unshift(firstField);%0A%20%20%20%20%20%20index%20=%200;%0A%20%20%20%20%7D%0A%0A%20%20%20%20await%20focusAndSelect(firstField);%0A%20%20%20%20await%20typeText(firstField,%20driver.firstName);%0A%0A%20%20%20%20const%20sequentialValues%20=%20%5Bdriver.lastName,%20driver.email,%20driver.phone%5D;%0A%0A%20%20%20%20const%20advanceToNext%20=%20async%20()%20=%3E%20%7B%0A%20%20%20%20%20%20for%20(let%20position%20=%20index%20+%201;%20position%20%3C%20tabStops.length;%20position%20+=%201)%20%7B%0A%20%20%20%20%20%20%20%20const%20candidate%20=%20tabStops%5Bposition%5D;%0A%20%20%20%20%20%20%20%20if%20(!isTabCandidate(candidate))%20continue;%0A%20%20%20%20%20%20%20%20index%20=%20position;%0A%20%20%20%20%20%20%20%20await%20focusAndSelect(candidate);%0A%20%20%20%20%20%20%20%20return%20candidate;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20throw%20new%20Error(%22Tabulator-Reihenfolge%20unvollst%C3%A4ndig%22);%0A%20%20%20%20%7D;%0A%0A%20%20%20%20for%20(const%20value%20of%20sequentialValues)%20%7B%0A%20%20%20%20%20%20const%20field%20=%20await%20advanceToNext();%0A%20%20%20%20%20%20if%20(value%20!=%20null)%20%7B%0A%20%20%20%20%20%20%20%20await%20typeText(field,%20value);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20flightNumber%20=%20driver.flightNumber;%0A%20%20%20%20if%20(flightNumber%20&&%20flightNumber%20!==%20%220%22)%20%7B%0A%20%20%20%20%20%20let%20attempts%20=%200;%0A%20%20%20%20%20%20while%20(attempts%20%3C%2012)%20%7B%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20candidate%20=%20await%20advanceToNext();%0A%20%20%20%20%20%20%20%20%20%20if%20(candidate?.name%20===%20%22vol%22)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20await%20typeText(candidate,%20flightNumber);%0A%20%20%20%20%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20catch%20(_error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20break;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20attempts%20+=%201;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20finalField%20=%20tabStops%5Bindex%5D;%0A%20%20%20%20if%20(finalField%20&&%20typeof%20finalField.blur%20===%20%22function%22)%20%7B%0A%20%20%20%20%20%20finalField.blur();%0A%20%20%20%20%7D%0A%20%20%7D;%0A%0A%20%20const%20runTariffFlow%20=%20async%20(data)%20=%3E%20%7B%0A%20%20%20%20const%20pickupSuccess%20=%20await%20fillAutocomplete(%7B%0A%20%20%20%20%20%20inputSelector:%20%22%23recherche-start%22,%0A%20%20%20%20%20%20station:%20data.pickupStation,%0A%20%20%20%20%7D);%0A%20%20%20%20if%20(!pickupSuccess)%20%7B%0A%20%20%20%20%20%20showToast(%22Startstation%20konnte%20nicht%20ausgew%C3%A4hlt%20werden.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20returnSuccess%20=%20await%20fillAutocomplete(%7B%0A%20%20%20%20%20%20inputSelector:%20%22%23recherche-end%22,%0A%20%20%20%20%20%20station:%20data.returnStation,%0A%20%20%20%20%7D);%0A%20%20%20%20if%20(!returnSuccess)%20%7B%0A%20%20%20%20%20%20showToast(%22R%C3%BCckgabestation%20konnte%20nicht%20ausgew%C3%A4hlt%20werden.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%0A%20%20%20%20await%20setDate(%22%23from%22,%20data.pickup?.date);%0A%20%20%20%20await%20setDate(%22%23to%22,%20data.return?.date);%0A%0A%20%20%20%20await%20setTime('select%5Bname=%22heure_a%22%5D',%20data.pickup?.time);%0A%20%20%20%20await%20setTime('select%5Bname=%22heure_d%22%5D',%20data.return?.time);%0A%0A%20%20%20%20showToast(%22Formular%20ausgef%C3%BCllt.%22);%0A%20%20%7D;%0A%0A%20%20const%20data%20=%20parseStorage();%0A%20%20if%20(!data)%20%7B%0A%20%20%20%20showToast(%22Keine%20Daten.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20return;%0A%20%20%7D%0A%0A%20%20const%20isBookingPage%20=%20/book%5C.asp/i.test(window.location.pathname);%0A%0A%20%20if%20(isBookingPage)%20%7B%0A%20%20%20%20if%20(!data.driver)%20%7B%0A%20%20%20%20%20%20showToast(%22Keine%20Fahrerinformationen%20gefunden.%22,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20%20%20return;%0A%20%20%20%20%7D%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20await%20fillDriverDetails(data.driver);%0A%20%20%20%20%20%20showToast(%22Personaldaten%20ausgef%C3%BCllt.%22);%0A%20%20%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20%20%20const%20message%20=%20error%20&&%20error.message%20?%20error.message%20:%20%22Unbekannter%20Fehler%22;%0A%20%20%20%20%20%20console.error(%22%5BBSP-Auto%5D%20fillDriverDetails%20fehlgeschlagen:%22,%20error);%0A%20%20%20%20%20%20showToast(%60Fehler%20beim%20Ausf%C3%BCllen%20der%20Personaldaten:%20$%7Bmessage%7D%60,%20%7B%20error:%20true%20%7D);%0A%20%20%20%20%7D%0A%20%20%20%20return;%0A%20%20%7D%0A%0A%20%20try%20%7B%0A%20%20%20%20await%20runTariffFlow(data);%0A%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20const%20message%20=%20error%20&&%20error.message%20?%20error.message%20:%20%22Unbekannter%20Fehler%22;%0A%20%20%20%20console.error(%22%5BBSP-Auto%5D%20runTariffFlow%20fehlgeschlagen:%22,%20error);%0A%20%20%20%20showToast(%60Fehler%20beim%20Ausf%C3%BCllen%20des%20Formulars:%20$%7Bmessage%7D%60,%20%7B%20error:%20true%20%7D);%0A%20%20%7D%0A%7D)();" data-tip="Drag to bookmarks" aria-label="Drag Fill - BSP Tarifs bookmarklet to your bar">ðŸ”— Code</a>
          <span class="drag-hint">â‡¢ Drag me</span>
          <span class="drag-divider" aria-hidden="true"></span>
          <div class="title-group">
            <span class="name">Fill Bookmarklet</span>
            <div class="bookmark-line"><span class="bookmark-name">Fill - BSP Tarifs</span><button class="copy-name" type="button" data-name="Fill - BSP Tarifs" data-tip="Copy name" aria-label="Copy bookmark name"><svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><rect x="8" y="3.5" width="11.5" height="14.5" rx="2.5" ry="2.5" fill="currentColor"/><rect x="4.5" y="6.5" width="11.5" height="14.5" rx="2.5" ry="2.5" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/></svg></button></div>
          </div>
        </div>
        <span class="badge">GENERAL</span>
      </div>
      <details><summary>More info</summary><div class="more">Fills in the simulation page with previously copied data from a reservation. Disclaimer can only be used together with &#039;Copy - BSP Resa&#039;</div></details>
    </article>
        </section>
        <aside class="card tutorial-card">
          <h2>Step-by-step</h2>
          <ol>
            <li><strong>Step 1:</strong> Click the copy icon to store the recommended bookmark name.</li>
            <li><strong>Step 2:</strong> Drag the <em>ðŸ”— Code</em> button into your bookmarks bar.</li>
            <li><strong>Step 3:</strong> Paste the name when your browser asks for it, then save.</li>
            <li><strong>Step 4:</strong> Open the bookmarklet on the target BSP Auto page.</li>
          </ol>
        </aside>
      </div>
    </main>
    <footer class="site-footer">&copy; BSP Auto 2025 Â· <strong>v1.0.0</strong> (2025-10-31 17:57)</footer>
  </div>
  <script>
(function(){
  function init(){
    const root=document.documentElement;
    const body=document.body;
    const themeBtn=document.getElementById('themeToggle');
    if(!themeBtn){console.warn('theme toggle button not found at init');}
    const prefersDark=window.matchMedia?window.matchMedia('(prefers-color-scheme: dark)'):{matches:false};

    function safeGet(key){
      try{return localStorage.getItem(key);}catch(e){return null;}
    }

    function safeSet(key,value){
      try{localStorage.setItem(key,value);}catch(e){}
    }

    function updateThemeToggle(mode){
      if(!themeBtn) return;
      themeBtn.setAttribute('aria-pressed',mode==='dark'?'true':'false');
      const nextLabel=mode==='dark'?'Switch to light mode':'Switch to dark mode';
      themeBtn.setAttribute('data-tip',nextLabel);
      themeBtn.setAttribute('aria-label',nextLabel);
    }

    function applyTheme(mode,options){
      const chosen=mode==='dark'?'dark':'light';
      root.setAttribute('data-theme',chosen);
      if(body){body.setAttribute('data-theme',chosen);}
      if(!options||options.store!==false){
        safeSet('theme',chosen);
      }
      updateThemeToggle(chosen);
    }

    const saved=safeGet('theme');
    const initial=saved==='dark'||saved==='light'?saved:prefersDark.matches?'dark':'light';
    applyTheme(initial,{store:false});

    if(themeBtn){
      themeBtn.addEventListener('click',()=>{
        const current=root.getAttribute('data-theme')==='dark'?'dark':'light';
        const next=current==='dark'?'light':'dark';
        applyTheme(next);
      });
    }

    function escapeHtmlLite(value){
      return value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    }

    document.querySelectorAll('a.btn').forEach(anchor=>{
      anchor.addEventListener('dragstart',ev=>{
        const url=anchor.getAttribute('href');
        const card=anchor.closest('article');
        const cleanup=value=>{
          if(value==null) return '';
          const text=String(value);
          let result='';
          let lastWasSpace=false;
          for(const ch of text){
            const isSpace=ch.trim()==='';
            if(isSpace){
              if(!lastWasSpace){
                result+=' ';
                lastWasSpace=true;
              }
            }else{
              result+=ch;
              lastWasSpace=false;
            }
          }
          return result.trim();
        };
        const datasetBookmark=cleanup(card?card.getAttribute('data-bookmark'):null);
        const datasetName=cleanup(card?card.getAttribute('data-id'):null);
        const ariaLabel=cleanup(anchor.getAttribute('aria-label'));
        const titleAttr=cleanup(anchor.getAttribute('title'));
        const finalTitle=datasetBookmark||datasetName||ariaLabel||titleAttr||url;
        ev.dataTransfer.effectAllowed='copy';
        try{ev.dataTransfer.setData('text/uri-list',url);}catch(e){}
        try{ev.dataTransfer.setData('text/plain',url);}catch(e){}
        try{ev.dataTransfer.setData('text/html','<a href="'+url+'">'+escapeHtmlLite(finalTitle)+'</a>');}catch(e){}
        try{ev.dataTransfer.setData('text/x-moz-url',url+'\n'+finalTitle);}catch(e){}
      });
    });

    document.querySelectorAll('.copy-name').forEach(button=>{
      const defaultTip=button.getAttribute('data-tip')||'';
      const name=button.getAttribute('data-name')||'';
      function resetTip(){
        button.setAttribute('data-tip',defaultTip);
        if(button._copyTimer){
          clearTimeout(button._copyTimer);
          button._copyTimer=null;
        }
      }
      function setTempTip(text){
        button.setAttribute('data-tip',text);
        if(button._copyTimer){
          clearTimeout(button._copyTimer);
        }
        button._copyTimer=window.setTimeout(()=>{
          resetTip();
        },1500);
      }
      function fallbackCopy(){
        const textarea=document.createElement('textarea');
        textarea.value=name;
        textarea.setAttribute('readonly','');
        textarea.style.position='absolute';
        textarea.style.left='-9999px';
        document.body.appendChild(textarea);
        textarea.select();
        let ok=false;
        try{
          ok=document.execCommand('copy');
        }catch(err){
          ok=false;
        }
        document.body.removeChild(textarea);
        return ok;
      }
      async function copy(){
        if(!name){
          setTempTip('No name');
          return;
        }
        try{
          if(navigator.clipboard&&navigator.clipboard.writeText){
            await navigator.clipboard.writeText(name);
            setTempTip('Copied!');
            return;
          }
          throw new Error('clipboard unavailable');
        }catch(err){
          if(fallbackCopy()){
            setTempTip('Copied!');
          }else{
            setTempTip('Copy failed');
          }
        }
      }
      button.addEventListener('click',copy);
      button.addEventListener('keydown',event=>{
        if(event.key==='Enter'||event.key===' '){
          event.preventDefault();
          copy();
        }
      });
      button.addEventListener('blur',resetTip);
    });
  }

  if(document.readyState==='loading'){
    window.addEventListener('DOMContentLoaded',init,{once:true});
  }else{
    init();
  }
})();
</script>
</body>
</html>